(function(e){function t(t){for(var c,o,r=t[0],i=t[1],u=t[2],b=0,d=[];b<r.length;b++)o=r[b],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&d.push(s[o][0]),s[o]=0;for(c in i)Object.prototype.hasOwnProperty.call(i,c)&&(e[c]=i[c]);l&&l(t);while(d.length)d.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],c=!0,r=1;r<n.length;r++){var i=n[r];0!==s[i]&&(c=!1)}c&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var c={},s={app:0},a=[];function o(t){if(c[t])return c[t].exports;var n=c[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=c,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)o.d(n,c,function(t){return e[t]}.bind(null,c));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/Redi/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],i=r.push.bind(r);r.push=t,r=r.slice();for(var u=0;u<r.length;u++)t(r[u]);var l=i;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0a4b":function(e,t,n){},"14e3":function(e,t,n){e.exports=n.p+"img/redi.10f611f2.svg"},"273f":function(e,t,n){},"4d18":function(e,t,n){"use strict";n("273f")},5058:function(e,t,n){e.exports=n.p+"img/avatar-bot.c72e65e8.png"},"527f":function(e,t,n){e.exports=n.p+"img/avatar-stranger.b0ed6063.png"},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var c=n("7a23"),s=function(e){return Object(c["y"])("data-v-99c93060"),e=e(),Object(c["w"])(),e},a={class:"App"},o={class:"layout_main"},r={class:"toast-container",style:{position:"fixed",bottom:"10px",right:"10px"}},i={id:"liveToast",class:"toast align-items-center border-1",role:"alert","aria-live":"assertive","aria-atomic":"true"},u={class:"d-flex"},l={class:"toast-body notify-success"},b=s((function(){return Object(c["f"])("button",{type:"button",class:"btn-close btn-close-white me-2 m-auto","data-bs-dismiss":"toast","aria-label":"Close"},null,-1)}));function d(e,t,n,s,d,f){var h=Object(c["C"])("Menu"),m=Object(c["C"])("Sidebar"),g=Object(c["C"])("Content");return Object(c["v"])(),Object(c["e"])("div",a,[Object(c["f"])("div",o,[Object(c["h"])(h),Object(c["h"])(m),Object(c["h"])(g)]),Object(c["f"])("div",r,[Object(c["f"])("div",i,[Object(c["f"])("div",u,[Object(c["f"])("div",l,Object(c["E"])(this.textNotify.substr(0,this.textNotify.length-2)),1),b])])])])}n("d3b7"),n("25f0");var f=n("14e3"),h=n.n(f),m={class:"menu"},g={class:"menu_item"},O=["title"],j=["src"],p={key:1,src:h.a,alt:"avatar"},v=Object(c["f"])("div",{class:"icon-message",href:"#"},[Object(c["f"])("i",{class:"bx bxs-message-rounded-dots"})],-1),y=[v],S=Object(c["f"])("a",{class:"icon-message"},[Object(c["f"])("i",{class:"bx bxs-contact"})],-1),k=[S],C=Object(c["f"])("div",{class:"icon-message"},[Object(c["f"])("i",{class:"bx bxs-log-out"})],-1),x=[C];function w(e,t,n,s,a,o){return Object(c["v"])(),Object(c["e"])("ul",m,[Object(c["f"])("li",g,[Object(c["f"])("div",{class:"menu_avatar",title:this.user.fullName,href:"#"},["notSignIn"!==a.statusMenu?(Object(c["v"])(),Object(c["e"])("img",{key:0,src:this.user.avatar,alt:"avatar"},null,8,j)):(Object(c["v"])(),Object(c["e"])("img",p))],8,O)]),Object(c["f"])("li",{onClick:t[0]||(t[0]=function(e){return o.clickChatMenu()}),class:Object(c["r"])([["chat"===a.statusMenu||"notSignIn"===a.statusMenu?"active":""],"menu_item"])},y,2),"notSignIn"!==a.statusMenu?(Object(c["v"])(),Object(c["e"])("li",{key:0,onClick:t[1]||(t[1]=function(e){return o.clickContactMenu()}),class:Object(c["r"])(["menu_item",["contacts"===a.statusMenu?"active":""]])},k,2)):Object(c["d"])("",!0),"notSignIn"!==a.statusMenu?(Object(c["v"])(),Object(c["e"])("li",{key:1,class:"menu_item menu_item-logout",onClick:t[2]||(t[2]=function(e){return o.signOut()})},x)):Object(c["d"])("",!0)])}var R=n("1da1"),_=(n("96cf"),n("5530")),M=n("d4ec"),F=n("bee2"),I=n("ade3"),U=n("daa8"),N=(n("159b"),n("77ba")),P=n("cee4"),B={headers:{"Content-Type":"application/json",Accept:"application/json"}},T=function(e){return P["a"].create(Object(_["a"])({baseURL:e},B))},E=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://redi-server-auth.onrender.com/api/auth";Object(M["a"])(this,e),this.api=T(t)}return Object(F["a"])(e,[{key:"signIn",value:function(){var e=Object(R["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.api.post("/signin",t);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"signUp",value:function(){var e=Object(R["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.api.post("/signup",t);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"signOut",value:function(){var e=Object(R["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.api.put("/signout",t);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"verifyToken",value:function(){var e=Object(R["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.api.post("/getinfo",t);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),q=new E,A=Object(N["b"])("store",{state:function(){return{statusMenu:"notSignIn",statusSidebar:"notSignIn",statusContent:"notSignIn",chatRoomStranger:"",user:{_id:"",phone:"",fullName:"",avatar:"",requestContact:[],contacts:[],chatRooms:[],token:""},currentChatRoom:{fullName:"",avatar:"",messages:[],_id:"",online:!1},foundUserByPhone:{fullName:"",_id:"",avatar:"",phone:""},notifyText:""}},getters:{},actions:{setFoundUserByPhone:function(e){this.foundUserByPhone=e},showNotify:function(e){this.notifyText=e},clickContactMenu:function(){this.statusMenu="contacts",this.statusSidebar="contacts",this.statusContent="contacts",this.currentChatRoom={fullName:"",avatar:"",messages:[],_id:""}},clickChatMenu:function(){this.statusMenu="chat",this.statusSidebar="chat",this.statusContent="noChatSelected"},clickContactsSidebar:function(){this.statusMenu="contacts",this.statusSidebar="contacts",this.statusContent="contacts"},clickRequestContactSidebar:function(){this.statusMenu="contacts",this.statusSidebar="requestContact",this.statusContent="requestContact"},signOut:function(){this.statusMenu="notSignIn",this.statusSidebar="notSignIn",this.statusContent="notSignIn",this.user={_id:"",phone:"",fullName:"",avatar:"",requestContact:[],contacts:[],chatRooms:[],token:""},this.currentChatRoom={fullName:"",avatar:"",messages:[],_id:""}},chatWithStranger:function(){this.statusContent="chatWithStranger"},switchChatContent:function(){this.statusContent="chat"},setChatRoomStranger:function(e){this.chatRoomStranger=e},setInfoUser:function(e){this.user=e,this.user.token=this.user.token.toString(),localStorage.setItem("token",e.token)},changeOnlineStatus:function(e,t){for(var n=this.user.chatRooms.length,c=0;c<n;c++)if(this.user.chatRooms[c]._id===e){this.user.chatRooms[c].online=t;break}},reloadData:function(){var e=this;return Object(R["a"])(regeneratorRuntime.mark((function t(){var n,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,n=localStorage.getItem("token"),!n){t.next=10;break}return W.disconnect(),t.next=6,q.verifyToken({token:n});case 6:c=t.sent,c&&(e.user=c.message),W.setupSocketFriendConnection(e.user.token,e.user.phone),W.receiveMessageFriend((function(t,n){console.log(n),n.roomID===e.currentChatRoom._id&&(e.currentChatRoom.messages.push(n),setTimeout((function(){var e=document.querySelector(".content_body");e.scrollTop=2*e.scrollHeight}),100)),e.user.chatRooms.forEach((function(t,c){n.roomID!==t._id||(e.user.chatRooms[c].lastMessageDate=n.createAt)}))}));case 10:t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()},setMessagesChatRoom:function(e){this.currentChatRoom.messages=e}}}),D=function(){function e(){Object(M["a"])(this,e),Object(I["a"])(this,"socketStranger",void 0),Object(I["a"])(this,"socketFriend",void 0),Object(I["a"])(this,"chatRoom",""),Object(I["a"])(this,"user",void 0)}return Object(F["a"])(e,[{key:"setupSocketStrangerConnection",value:function(){this.socketStranger=Object(U["a"])("https://redi-server-stranger.onrender.com",{}),console.log("Connecting socket...")}},{key:"setupSocketFriendConnection",value:function(e,t){this.socketFriend=Object(U["a"])("https://redi-server-friend.onrender.com",{auth:{token:e}}),console.log("Connecting socket..."),console.log("socketFriend",this.socketFriend),this.socketFriend.on("onlineStatus",(function(e){A().changeOnlineStatus(e.roomID,e.online)})),this.socketFriend.emit("sendUser",t),this.socketFriend.on("message",(function(e){A().reloadData(),A().showNotify(e),console.log("message",e)})),this.socketFriend.on("receiveContentChatRoom",(function(e){console.log(e),A().setMessagesChatRoom(e)}))}},{key:"loadContentChatRoom",value:function(e){this.socketFriend.emit("loadContentChatRoom",e)}},{key:"findUserByPhone",value:function(e){this.socketFriend.emit("findUser",e),this.socketFriend.on("foundUser",(function(e){console.log("foundUser",e),A().setFoundUserByPhone(e)}))}},{key:"actionFriendRequest",value:function(e){this.socketFriend.emit("actionFriendRequest",e)}},{key:"sendFriendRequest",value:function(e){this.socketFriend.emit("sendFriendRequest",e)}},{key:"receiveMessageFriend",value:function(e){if(!this.socketFriend)return!0;console.log("receiveMessageFriend"),this.socketFriend.on("receiveMessageFriend",(function(t){return e(null,t)}))}},{key:"sendMessageFriend",value:function(e,t){this.socketFriend&&this.socketFriend.emit("sendMessageFriend",e,t)}},{key:"receiveMessageStranger",value:function(e){if(!this.socketStranger)return!0;this.socketStranger.on("receiveMessageStranger",(function(t){return e(null,Object(_["a"])(Object(_["a"])({},t),{},{name:"Người lạ"}))}))}},{key:"statusRoomStranger",value:function(e){if(!this.socketStranger)return!0;this.socketStranger.on("statusRoomStranger",(function(t){return e(null,Object(_["a"])(Object(_["a"])({},t),{},{name:"Bot"}))}))}},{key:"nextRoomStranger",value:function(e){this.socketStranger.emit("nextRoomStranger",e),console.log("id",this.socketStranger.id)}},{key:"sendMessageStranger",value:function(e,t){this.socketStranger&&this.socketStranger.emit("sendMessageStranger",e,t)}},{key:"disconnectStranger",value:function(){this.socketStranger&&this.socketStranger.disconnect()}},{key:"disconnect",value:function(){this.socketFriend&&this.socketFriend.disconnect()}}]),e}(),W=new D,L={name:"Menu",props:{},components:{},mounted:function(){},data:function(){var e=A(),t=Object(N["c"])(e),n=t.statusMenu,c=Object(N["c"])(e),s=c.user;return{statusMenu:n,user:s}},watch:{},methods:{clickContactMenu:function(){A().clickContactMenu()},clickChatMenu:function(){"notSignIn"!==this.statusMenu?A().clickChatMenu():alert("Bạn phải đăng nhập để thực hiện chức năng này !")},signOut:function(){var e=this;return Object(R["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!confirm("Bạn muốn đăng xuất khỏi tài khoản này ?")){t.next=8;break}return t.next=4,q.signOut({phone:e.user.phone});case 4:W.disconnect(),localStorage.removeItem("token"),A().signOut(),location.reload();case 8:t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()}},beforeUnmount:function(){}};L.render=w;var V=L,H=(n("caad"),n("2532"),function(e){return Object(c["y"])("data-v-a8eb7e24"),e=e(),Object(c["w"])(),e}),z=H((function(){return Object(c["f"])("div",{class:"overlay"},null,-1)})),K={class:"modal_form-sign"},J=H((function(){return Object(c["f"])("div",{class:"modal_form-sign-heading"},[Object(c["f"])("h1",null,"Đăng Ký")],-1)})),Q=H((function(){return Object(c["f"])("div",{class:"icon-close"},[Object(c["f"])("i",{class:"bx bx-x"})],-1)})),X={class:"form-group"},$=H((function(){return Object(c["f"])("label",{for:"fullName"},"Họ và tên",-1)})),G={class:"form-group"},Y=H((function(){return Object(c["f"])("label",{for:"phone"},"Điện thoại",-1)})),Z={class:"form-group"},ee=H((function(){return Object(c["f"])("label",{for:"password"},"Mật Khẩu",-1)})),te={class:"form-group"},ne=H((function(){return Object(c["f"])("label",{for:"confirmPassword"},"Xác nhận lại mật khẩu",-1)})),ce={class:"form-group"},se=H((function(){return Object(c["f"])("label",null,"Ảnh đại diện: ",-1)})),ae=H((function(){return Object(c["f"])("button",{class:"btn btn-signup"},"Đăng ký",-1)})),oe=H((function(){return Object(c["f"])("div",{class:"login-signup"},[Object(c["f"])("span",{class:"text"},"Đã có tài khoản"),Object(c["f"])("a",{href:"#",class:"text login-link"},"Đăng nhập")],-1)})),re={class:"modal_form-login"},ie=H((function(){return Object(c["f"])("div",{class:"modal_form-sign-heading"},[Object(c["f"])("h1",null,"Đăng Nhập")],-1)})),ue=H((function(){return Object(c["f"])("div",{class:"icon-close"},[Object(c["f"])("i",{class:"bx bx-x"})],-1)})),le={class:"form-group"},be=H((function(){return Object(c["f"])("label",{for:"phone"},"Điện thoại",-1)})),de={class:"form-group"},fe=H((function(){return Object(c["f"])("label",{for:"password"},"Mật Khẩu",-1)})),he=H((function(){return Object(c["f"])("button",{class:"btn btn-signup"},"Đăng nhập",-1)})),me=H((function(){return Object(c["f"])("div",{class:"login-signup"},[Object(c["f"])("span",{class:"text"},"Bạn chưa có tài khoản? Hãy chọn"),Object(c["f"])("a",{href:"#",class:"text signup-link"},"Đăng ký")],-1)})),ge={class:"sidebar"},Oe={class:"sidebar_list"},je={key:0,class:"sidebar_item-search"},pe=H((function(){return Object(c["f"])("i",{class:"bx bx-search"},null,-1)})),ve=["title","onClick"],ye=["src"],Se={key:0,class:"fa-solid fa-circle"},ke={class:"sidebar_content"},Ce={class:"sidebar_name"},xe={class:"content_body-signup"},we=H((function(){return Object(c["f"])("button",{href:"#",class:"btn btn-sign",id:"open-form-dangnhap1"},"Đăng Ký",-1)})),Re=H((function(){return Object(c["f"])("button",{href:"#",class:"btn btn-log"},"Đăng Nhập",-1)})),_e=H((function(){return Object(c["f"])("div",{class:"note"},' *Bằng cách bấm vào phần "Người lạ", bạn có thể trò chuyện ngay với người lạ mà không cần Đăng nhập. ',-1)})),Me=[we,Re,_e],Fe=H((function(){return Object(c["f"])("i",{class:"bx bxs-group"},null,-1)})),Ie=H((function(){return Object(c["f"])("div",{class:"sidebar_content"},[Object(c["f"])("h3",{class:"sidebar_name"},"Danh sách bạn bè")],-1)})),Ue=[Fe,Ie],Ne=H((function(){return Object(c["f"])("i",{class:"bx bxs-user-plus"},null,-1)})),Pe=H((function(){return Object(c["f"])("div",{class:"sidebar_content"},[Object(c["f"])("h3",{class:"sidebar_name"},"Danh sách kết bạn")],-1)})),Be=[Ne,Pe],Te=["title"],Ee=["src"],qe={class:"sidebar_content"},Ae={class:"sidebar_name"};function De(e,t,n,s,a,o){var r=this,i=Object(c["C"])("Field"),u=Object(c["C"])("ErrorMessage"),l=Object(c["C"])("Form");return Object(c["v"])(),Object(c["e"])(c["a"],null,[z,Object(c["f"])("div",K,[J,Q,Object(c["h"])(l,{onSubmit:t[5]||(t[5]=function(e){return o.signUp()}),"validation-schema":a.dataSignUpFormSchema,class:"form-sign",ref:"formSignUp"},{default:Object(c["O"])((function(){return[Object(c["f"])("div",X,[$,Object(c["h"])(i,{name:"fullName",type:"text",class:"form-control",modelValue:a.dataSignUp.fullName,"onUpdate:modelValue":t[0]||(t[0]=function(e){return a.dataSignUp.fullName=e})},null,8,["modelValue"]),Object(c["h"])(u,{name:"fullName",class:"error-feedback"})]),Object(c["f"])("div",G,[Y,Object(c["h"])(i,{name:"phone",type:"tel",class:"form-control",modelValue:a.dataSignUp.phone,"onUpdate:modelValue":t[1]||(t[1]=function(e){return a.dataSignUp.phone=e})},null,8,["modelValue"]),Object(c["h"])(u,{name:"phone",class:"error-feedback"})]),Object(c["f"])("div",Z,[ee,Object(c["h"])(i,{name:"password",type:"password",class:"form-control",modelValue:a.dataSignUp.password,"onUpdate:modelValue":t[2]||(t[2]=function(e){return a.dataSignUp.password=e})},null,8,["modelValue"]),Object(c["h"])(u,{name:"password",class:"error-feedback"})]),Object(c["f"])("div",te,[ne,Object(c["h"])(i,{name:"confirmPassword",type:"password",class:"form-control",modelValue:a.dataSignUp.confirmPassword,"onUpdate:modelValue":t[3]||(t[3]=function(e){return a.dataSignUp.confirmPassword=e})},null,8,["modelValue"]),Object(c["h"])(u,{name:"confirmPassword",class:"error-feedback"})]),Object(c["f"])("div",ce,[se,Object(c["f"])("button",{type:"button",onClick:t[4]||(t[4]=function(e){return o.openUploadModal()})},Object(c["E"])(""===r.dataSignUp.avatar?"Upload ảnh làm ảnh đại diện.":r.nameFileAvatar),1)]),ae,oe]})),_:1},8,["validation-schema"])]),Object(c["f"])("div",re,[ie,ue,Object(c["h"])(l,{onSubmit:t[8]||(t[8]=function(e){return o.signIn()}),"validation-schema":a.dataSignInFormSchema,class:"form-sign",ref:"formSignIn"},{default:Object(c["O"])((function(){return[Object(c["f"])("div",le,[be,Object(c["h"])(i,{name:"phone",type:"tel",class:"form-control",modelValue:a.dataSignIn.phone,"onUpdate:modelValue":t[6]||(t[6]=function(e){return a.dataSignIn.phone=e})},null,8,["modelValue"]),Object(c["h"])(u,{name:"phone",class:"error-feedback"})]),Object(c["f"])("div",de,[fe,Object(c["h"])(i,{name:"password",type:"password",class:"form-control",modelValue:a.dataSignIn.password,"onUpdate:modelValue":t[7]||(t[7]=function(e){return a.dataSignIn.password=e})},null,8,["modelValue"]),Object(c["h"])(u,{name:"password",class:"error-feedback"})]),he,me]})),_:1},8,["validation-schema"])]),Object(c["f"])("div",ge,[Object(c["f"])("div",Oe,["notSignIn"!==a.statusSidebar?(Object(c["v"])(),Object(c["e"])("div",je,[Object(c["f"])("form",{onSubmit:t[10]||(t[10]=Object(c["Q"])((function(e){return r.findUserByPhone()}),["prevent"]))},[Object(c["P"])(Object(c["f"])("input",{type:"text",placeholder:"Tìm kiếm","onUpdate:modelValue":t[9]||(t[9]=function(e){return r.searchByPhone=e})},null,512),[[c["J"],this.searchByPhone]])],32),pe])):Object(c["d"])("",!0),"notSignIn"===a.statusSidebar||"chat"===a.statusSidebar?(Object(c["v"])(!0),Object(c["e"])(c["a"],{key:1},Object(c["B"])(this.chatRooms,(function(e,t){return Object(c["v"])(),Object(c["e"])("div",{key:t,class:Object(c["r"])(["sidebar_item",[e._id===r.currentChatRoom._id?"active":""]]),title:e.fullNameFriend,onClick:function(t){return o.openChatContent(e)}},[Object(c["f"])("img",{src:e.avatar,alt:""},null,8,ye),e.online?(Object(c["v"])(),Object(c["e"])("i",Se)):Object(c["d"])("",!0),Object(c["f"])("div",ke,[Object(c["f"])("h3",Ce,Object(c["E"])(e.fullNameFriend),1)])],10,ve)})),128)):Object(c["d"])("",!0),Object(c["P"])(Object(c["f"])("div",xe,Me,512),[[c["K"],"notSignIn"===a.statusSidebar]]),a.statusSidebar.includes("ontact")&&!this.checkSearchByPhone?(Object(c["v"])(),Object(c["e"])(c["a"],{key:2},[Object(c["f"])("div",{onClick:t[11]||(t[11]=function(e){return o.clickContactsSidebar()})},[Object(c["f"])("div",{class:Object(c["r"])(["sidebar_item",["contacts"===a.statusSidebar?"active":""]])},Ue,2)]),Object(c["f"])("div",{onClick:t[12]||(t[12]=function(e){return o.clickRequestContactSidebar()&&!r.checkSearchByPhone})},[Object(c["f"])("div",{class:Object(c["r"])(["sidebar_item",["requestContact"===a.statusSidebar?"active":""]])},Be,2)])],64)):Object(c["d"])("",!0),this.foundUserByPhone.fullName&&this.chatRooms.length<1?(Object(c["v"])(),Object(c["e"])("div",{key:3,class:"sidebar_item",title:this.foundUserByPhone.fullName},[Object(c["f"])("img",{src:this.foundUserByPhone.avatar,alt:""},null,8,Ee),Object(c["f"])("div",qe,[Object(c["f"])("h3",Ae,Object(c["E"])(this.foundUserByPhone.fullName),1)]),Object(c["f"])("button",{id:"btn-requestContact",onClick:t[13]||(t[13]=function(e){return o.sendFriendRequest()})}," Kết bạn ")],8,Te)):Object(c["d"])("",!0)])])],64)}n("ac1f"),n("466d"),n("d81d"),n("a15b"),n("4e82"),n("99af"),n("4de4"),n("1276");var We=n("42e9"),Le=n("7bb1"),Ve={name:"Sidebar",props:{},components:{Form:Le["c"],Field:Le["b"],ErrorMessage:Le["a"]},mounted:function(){this.processFormSignInSignUp(),this.verifyToken()},data:function(){var e=A(),t=Object(N["c"])(e),n=t.statusSidebar,c=Object(N["c"])(e),s=c.statusContent,a=Object(N["c"])(e),o=a.user,r=Object(N["c"])(e),i=r.currentChatRoom,u=Object(N["c"])(e),l=u.foundUserByPhone,b=We["a"]().shape({fullName:We["c"]().required("Họ và tên phải có giá trị.").min(8,"Họ và tên phải ít nhất 8 ký tự.").matches("[a-zA-Z]","Họ và tên phải ít một ký tự chữ cái.").max(50,"Họ và tên có nhiều nhất 50 ký tự."),password:We["c"]().required("Mật khẩu phải có giá trị.").min(8,"Mật khẩu phải ít nhất 8 ký tự."),phone:We["c"]().matches(/((09|03|07|08|05)+([0-9]{8})\b)/g,"Số điện thoại không hợp lệ."),confirmPassword:We["c"]().oneOf([We["b"]("password"),null],"Mật khẩu phải trùng khớp.")}),d=We["a"]().shape({password:We["c"]().required("Mật khẩu phải có giá trị.").min(8,"Mật khẩu phải ít nhất 8 ký tự."),phone:We["c"]().matches(/((09|03|07|08|05)+([0-9]{8})\b)/g,"Số điện thoại không hợp lệ.")});return{statusSidebar:n,statusContent:s,dataSignUp:{phone:"",password:"",fullName:"",confirmPassword:"",avatar:""},dataSignIn:{phone:"",password:""},dataSignUpFormSchema:b,dataSignInFormSchema:d,nameFileAvatar:"",user:o,searchByPhone:"",currentChatRoom:i,foundUserByPhone:l,checkSearchByPhone:!1}},watch:{searchByPhone:function(){var e=this.searchByPhone.match(/((09|03|07|08|05)+([0-9]{8})\b)/);e||(this.foundUserByPhone={fullName:"",_id:"",avatar:"",phone:""},this.checkSearchByPhone=!1)}},computed:{chatRoomsString:function(){var e=this,t=this.user.chatRooms.map((function(t){if("000"===t._id)return"";console.log(t.owner);var n,c=t.owner[0]===e.user._id?t.owner[1]:t.owner[0];return e.user.contacts.forEach((function(e){c===e._id&&(n=e.phone)})),[n,t.fullNameFriend].join("")}));return console.log(t),t},chatRooms:function(){var e=this;if(""===this.searchByPhone){var t={_id:"000",owner:[],lastMessageDate:"0:0 0-0-0",fullNameFriend:"Người lạ",avatar:"http://res.cloudinary.com/dwnunieno/image/upload/v1679058005/sdrdzt5t2bhs5lvgsflj.png",online:!1},n=this.user.chatRooms;return n.sort(this.compareFn),[t].concat(n)}var c=this.user.chatRooms.filter((function(t,n){return e.chatRoomsString[n].includes(e.searchByPhone)})).sort(this.compareFn);return c}},methods:{compareFn:function(e,t){var n,c,s,a,o,r,i,u,l,b,d=e.lastMessageDate.split(" "),f=t.lastMessageDate.split(" ");return n=parseInt(d[0].split(":")[0]),c=parseInt(d[0].split(":")[1]),s=parseInt(d[1].split("-")[0]),a=parseInt(d[1].split("-")[1]),o=parseInt(d[1].split("-")[2]),r=parseInt(f[0].split(":")[0]),i=parseInt(f[0].split(":")[1]),u=parseInt(f[1].split("-")[0]),l=parseInt(f[1].split("-")[1]),b=parseInt(f[1].split("-")[2]),o!==b?b-o:a!==l?l-a:s!==u?u-s:n!==r?r-n:c!==i?i-c:0},processFormSignInSignUp:function(){var e=document.querySelector(".btn-sign"),t=document.querySelector(".modal_form-sign"),n=document.querySelectorAll(".icon-close"),c=document.querySelector(".btn-log"),s=document.querySelector(".modal_form-login"),a=document.querySelector(".overlay"),o=document.querySelector(".signup-link"),r=document.querySelector(".login-link");e.addEventListener("click",(function(){t.classList.add("open"),a.classList.add("open")})),c.addEventListener("click",(function(){s.classList.add("open"),a.classList.add("open")})),n.forEach((function(e){e.addEventListener("click",(function(){t.classList.remove("open"),s.classList.remove("open"),a.classList.remove("open")}))})),o.addEventListener("click",(function(){t.classList.add("open"),s.classList.remove("open")})),r.addEventListener("click",(function(){s.classList.add("open"),t.classList.remove("open")}))},autoSrcollTop:function(){setTimeout((function(){var e=document.querySelector(".content_body");e.scrollTop=2*e.scrollHeight}),500)},verifyToken:function(){var e=this;return Object(R["a"])(regeneratorRuntime.mark((function t(){var n,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,n=localStorage.getItem("token"),!n){t.next=7;break}return t.next=5,q.verifyToken({token:n});case 5:c=t.sent,c&&(A().setInfoUser(c.message),W.setupSocketFriendConnection(c.message.token,c.message.phone),W.receiveMessageFriend((function(t,n){console.log(n),n.roomID===e.currentChatRoom._id&&(e.currentChatRoom.messages.push(n),e.autoSrcollTop()),e.user.chatRooms.forEach((function(t,c){n.roomID!==t._id||(e.user.chatRooms[c].lastMessageDate=n.createAt)}))})),A().clickChatMenu());case 7:t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},clickContactsSidebar:function(){A().clickContactsSidebar()},clickRequestContactSidebar:function(){A().clickRequestContactSidebar()},openChatContent:function(e){this.currentChatRoom=Object(_["a"])(Object(_["a"])({},e),{},{messages:[]}),"000"===e._id?A().chatWithStranger():(W.loadContentChatRoom(e._id.toString()),this.autoSrcollTop(),A().switchChatContent())},openUploadModal:function(){var e=this,t=window.cloudinary.createUploadWidget({cloud_name:"dwnunieno",upload_preset:"ma9pfovj",maxImageFileSize:1e7,autoMinimize:!0,sources:["local"],clientAllowedFormats:["image"],maxFiles:1},function(){var n=Object(R["a"])(regeneratorRuntime.mark((function n(c,s){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(c||!s||"success"!==s.event){n.next=8;break}return console.log("Done uploading..: ",s.info),e.dataSignUp.avatar=s.info.url,console.log(s.info),console.log(e.dataSignUp.avatar),e.nameFileAvatar=s.info.original_filename+"."+s.info.format,n.next=8,t.destroy({removeThumbnails:!0}).then((function(){console.log("Widget was destroyed")}));case 8:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()).open()},signUp:function(){var e=this;return Object(R["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,""===e.dataSignUp.avatar&&(e.dataSignUp.avatar="https://res.cloudinary.com/dwnunieno/image/upload/v1678895187/ojzoerhuvkv8ealatzqz.png"),t.next=4,q.signUp(e.dataSignUp);case 4:n=t.sent,document.querySelector(".modal_form-sign").classList.remove("open"),document.querySelector(".modal_form-login").classList.add("open"),e.dataSignUp={phone:"",password:"",fullName:"",address:"",avatar:""},setTimeout(e.$refs.formSignUp.resetForm,1500),n&&alert(n.message),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),alert(t.t0.response.data.message.toString());case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()},signIn:function(){var e=this;return Object(R["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,q.signIn(e.dataSignIn);case 3:n=t.sent,A().setInfoUser(n.message),W.setupSocketFriendConnection(n.message.token,n.message.phone),document.querySelector(".modal_form-login").classList.remove("open"),document.querySelector(".overlay").classList.remove("open"),A().clickChatMenu(),e.dataSignIn={phone:"",password:""},W.receiveMessageFriend((function(t,n){console.log(n),n.roomID===e.currentChatRoom._id&&(e.currentChatRoom.messages.push(n),e.autoSrcollTop()),e.user.chatRooms.forEach((function(t,c){n.roomID!==t._id||(e.user.chatRooms[c].lastMessageDate=n.createAt)}))})),setTimeout(e.$refs.formSignIn.resetForm,1e3),n&&console.log(n.message),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](0),alert(t.t0.response.data.message.toString());case 18:case"end":return t.stop()}}),t,null,[[0,15]])})))()},findUserByPhone:function(){var e=this;if(!(this.chatRooms.length>0)){if(this.searchByPhone===this.user.phone)return alert(this.user.phone+" là số điện thoại của bạn mà !"),void(this.searchByPhone="");var t=this.searchByPhone.match(/((09|03|07|08|05)+([0-9]{8})\b)/);t?(this.user.requestContact.forEach((function(n){if(n.phone===e.searchByPhone)return alert('Số điện thoại: "'.concat(e.searchByPhone,'" (').concat(n.fullName,") đã gửi lời mời kết bạn cho bạn !")),e.searchByPhone="",void(t=!1)})),t&&(W.findUserByPhone(this.searchByPhone),this.checkSearchByPhone=!0,console.log(this.searchByPhone),this.currentChatRoom={fullName:"",avatar:"",messages:[],_id:""},this.statusContent="noChatSelected")):alert('Số điện thoại: "'.concat(this.searchByPhone,'" chưa hợp lệ !'))}},sendFriendRequest:function(){W.sendFriendRequest(this.foundUserByPhone.phone),this.searchByPhone="",this.foundUserByPhone={fullName:"",_id:"",avatar:"",phone:""}}},beforeUnmount:function(){}};n("e5b1");Ve.render=De,Ve.__scopeId="data-v-a8eb7e24";var He=Ve,ze=(n("b0c0"),n("527f")),Ke=n.n(ze),Je=n("5058"),Qe=n.n(Je),Xe=n("e7ba"),$e=n.n(Xe),Ge=function(e){return Object(c["y"])("data-v-34844884"),e=e(),Object(c["w"])(),e},Ye={key:0,class:"content"},Ze={class:"content_header"},et=["src"],tt={key:0,class:"fa-solid fa-circle"},nt={class:"content_header-title"},ct={class:"content_body"},st={class:"chat-box"},at={key:0},ot={key:0,class:"mess-incoming"},rt={class:"mess-avatar"},it=["src"],ut={key:0,class:"details",style:{"margin-bottom":"10px"}},lt={class:"mess-text"},bt={class:"mess-name"},dt={class:"mess-time"},ft=Ge((function(){return Object(c["f"])("br",null,null,-1)})),ht={key:1,class:"mess-img",style:{"margin-bottom":"10px"}},mt=["src"],gt={key:1,class:"mess-outgoing"},Ot={key:0,class:"mess-text",style:{"margin-bottom":"10px"}},jt={class:"mess-time"},pt=Ge((function(){return Object(c["f"])("br",null,null,-1)})),vt={key:1,class:"mess-img",style:{"margin-bottom":"10px"}},yt=["src"],St={key:1},kt={key:0,class:"mess-incoming"},Ct={class:"mess-avatar"},xt=["src"],wt={key:0,class:"details"},Rt={class:"mess-text"},_t={class:"mess-name"},Mt={class:"mess-time"},Ft=Ge((function(){return Object(c["f"])("br",null,null,-1)})),It={key:1,class:"mess-img",style:{"margin-bottom":"10px"}},Ut=["src"],Nt={key:1,class:"mess-outgoing"},Pt={key:0,class:"mess-text"},Bt={class:"mess-time"},Tt=Ge((function(){return Object(c["f"])("br",null,null,-1)})),Et={key:1,class:"mess-img",style:{"margin-bottom":"10px"}},qt=["src"],At={class:"chat-footer"},Dt={class:"chat-footer"},Wt=Ge((function(){return Object(c["f"])("i",{class:"fa-solid fa-image"},null,-1)})),Lt=[Wt],Vt=Ge((function(){return Object(c["f"])("button",{type:"submit"},[Object(c["f"])("i",{class:"fa-solid fa-paper-plane"})],-1)})),Ht={key:1,class:"content"},zt={class:"content_header"},Kt=Ge((function(){return Object(c["f"])("img",{class:"content_header-img",src:Ke.a,alt:""},null,-1)})),Jt=Ge((function(){return Object(c["f"])("div",{class:"content_header-title"},[Object(c["f"])("h1",null,"Người lạ")],-1)})),Qt={class:"content_header-right"},Xt=Ge((function(){return Object(c["f"])("i",{class:"fa-solid fa-comment-medical"},null,-1)})),$t=Ge((function(){return Object(c["f"])("i",{class:"fa-solid fa-comment-slash"},null,-1)})),Gt={class:"content_body"},Yt={class:"chat-box"},Zt={key:0},en={key:0,class:"mess-incoming"},tn=Ge((function(){return Object(c["f"])("div",{class:"mess-avatar"},[Object(c["f"])("img",{src:Ke.a,alt:""})],-1)})),nn={key:0,class:"details",style:{"margin-bottom":"10px"}},cn={class:"mess-text"},sn={class:"mess-name"},an={class:"mess-time"},on=Ge((function(){return Object(c["f"])("br",null,null,-1)})),rn={key:1,class:"mess-img"},un=["src"],ln={key:1,class:"mess-incoming"},bn=Ge((function(){return Object(c["f"])("div",{class:"mess-avatar"},[Object(c["f"])("img",{src:Qe.a,alt:""})],-1)})),dn={class:"details"},fn={class:"mess-text",style:{"margin-bottom":"10px"}},hn={class:"mess-name"},mn={class:"mess-time"},gn=Ge((function(){return Object(c["f"])("br",null,null,-1)})),On={key:2,class:"mess-outgoing"},jn={key:0,class:"mess-text",style:{"margin-bottom":"10px"}},pn={class:"mess-time"},vn=Ge((function(){return Object(c["f"])("br",null,null,-1)})),yn={key:1,class:"mess-img"},Sn=["src"],kn={key:1},Cn={key:0,class:"mess-incoming"},xn=Ge((function(){return Object(c["f"])("div",{class:"mess-avatar"},[Object(c["f"])("img",{src:Ke.a,alt:""})],-1)})),wn={key:0,class:"details"},Rn={class:"mess-text"},_n={class:"mess-name"},Mn={class:"mess-time"},Fn=Ge((function(){return Object(c["f"])("br",null,null,-1)})),In={key:1,class:"mess-img"},Un=["src"],Nn={key:1,class:"mess-incoming"},Pn=Ge((function(){return Object(c["f"])("div",{class:"mess-avatar"},[Object(c["f"])("img",{src:Qe.a,alt:""})],-1)})),Bn={class:"details"},Tn={class:"mess-text"},En={class:"mess-name"},qn={class:"mess-time"},An=Ge((function(){return Object(c["f"])("br",null,null,-1)})),Dn={key:2,class:"mess-outgoing"},Wn={key:0,class:"mess-text"},Ln={class:"mess-time"},Vn=Ge((function(){return Object(c["f"])("br",null,null,-1)})),Hn={key:1,class:"mess-img"},zn=["src"],Kn={class:"chat-footer"},Jn=Ge((function(){return Object(c["f"])("i",{class:"fa-solid fa-image"},null,-1)})),Qn=[Jn],Xn=Ge((function(){return Object(c["f"])("button",{id:"btn-sendMess",type:"submit"},[Object(c["f"])("i",{class:"fa-solid fa-paper-plane"})],-1)})),$n={key:2,class:"contact_main"},Gn=Ge((function(){return Object(c["f"])("div",{class:"content_header"},[Object(c["f"])("i",{class:"bx bxs-user-plus"}),Object(c["f"])("div",{class:"content_header-title"},[Object(c["f"])("h1",null,"Danh sách kết bạn")])],-1)})),Yn={class:"contact_list"},Zn=["title"],ec=["src"],tc={class:"contact_content"},nc={class:"contact_name"},cc={class:"contact_action"},sc=["onClick"],ac=["onClick"],oc={key:3,class:"contact_main"},rc=Ge((function(){return Object(c["f"])("div",{class:"content_header"},[Object(c["f"])("i",{class:"bx bxs-group"}),Object(c["f"])("div",{class:"content_header-title"},[Object(c["f"])("h1",null,"Danh sách bạn bè")])],-1)})),ic={class:"contact_list"},uc=["title"],lc=["src"],bc={class:"contact_content"},dc={class:"contact_name"},fc={key:4,class:"contact_main introduce"},hc=Ge((function(){return Object(c["f"])("img",{src:$e.a,alt:""},null,-1)})),mc=Ge((function(){return Object(c["f"])("h1",null,"REDI",-1)})),gc=Ge((function(){return Object(c["f"])("h2",null,"XOÁ NHOÀ KHOẢNG CÁCH",-1)})),Oc=[hc,mc,gc],jc={key:5,class:"contact_main no-chat-selected"},pc=Ge((function(){return Object(c["f"])("img",{src:$e.a,alt:""},null,-1)})),vc=Ge((function(){return Object(c["f"])("p",null,"chào mừng bạn đến với REDI, ",-1)})),yc=Ge((function(){return Object(c["f"])("p",null,"bắt đầu trò chuyện với những người mà bạn yêu thương nào !",-1)}));function Sc(e,t,n,s,a,o){var r=this;return Object(c["v"])(),Object(c["e"])(c["a"],null,["chat"===a.statusContent?(Object(c["v"])(),Object(c["e"])("div",Ye,[Object(c["f"])("div",Ze,[Object(c["f"])("img",{class:"content_header-img",src:this.currentChatRoom.avatar,alt:""},null,8,et),Object(c["f"])("span",null,[this.currentChatRoom.online?(Object(c["v"])(),Object(c["e"])("i",tt)):Object(c["d"])("",!0)]),Object(c["f"])("div",nt,[Object(c["f"])("h1",null,Object(c["E"])(this.currentChatRoom.fullNameFriend),1)])]),Object(c["f"])("div",ct,[Object(c["f"])("div",st,[(Object(c["v"])(!0),Object(c["e"])(c["a"],null,Object(c["B"])(this.messages,(function(e,t){return Object(c["v"])(),Object(c["e"])(c["a"],{key:t},[t===r.currentChatRoom.messages.length-1&&t>2?(Object(c["v"])(),Object(c["e"])("div",at,[e.owner!==r.user._id?(Object(c["v"])(),Object(c["e"])("div",ot,[Object(c["f"])("div",rt,[Object(c["f"])("img",{src:r.currentChatRoom.avatar,alt:""},null,8,it)]),"text"===e.type?(Object(c["v"])(),Object(c["e"])("div",ut,[Object(c["f"])("div",lt,[Object(c["f"])("div",bt,Object(c["E"])(r.currentChatRoom.fullNameFriend),1),Object(c["g"])(" "+Object(c["E"])(e.content)+" ",1),Object(c["f"])("div",dt,[ft,Object(c["g"])(Object(c["E"])(e.createAt),1)])])])):"image"===e.type?(Object(c["v"])(),Object(c["e"])("div",ht,[Object(c["f"])("img",{src:e.content,alt:""},null,8,mt)])):Object(c["d"])("",!0)])):(Object(c["v"])(),Object(c["e"])("div",gt,["text"===e.type?(Object(c["v"])(),Object(c["e"])("div",Ot,[Object(c["g"])(Object(c["E"])(e.content)+" ",1),Object(c["f"])("div",jt,[pt,Object(c["g"])(Object(c["E"])(e.createAt),1)])])):"image"===e.type?(Object(c["v"])(),Object(c["e"])("div",vt,[Object(c["f"])("img",{src:e.content,alt:""},null,8,yt)])):Object(c["d"])("",!0)]))])):(Object(c["v"])(),Object(c["e"])("div",St,[e.owner!==r.user._id?(Object(c["v"])(),Object(c["e"])("div",kt,[Object(c["f"])("div",Ct,[Object(c["f"])("img",{src:r.currentChatRoom.avatar,alt:""},null,8,xt)]),"text"===e.type?(Object(c["v"])(),Object(c["e"])("div",wt,[Object(c["f"])("div",Rt,[Object(c["f"])("div",_t,Object(c["E"])(r.currentChatRoom.fullNameFriend),1),Object(c["g"])(" "+Object(c["E"])(e.content)+" ",1),Object(c["f"])("div",Mt,[Ft,Object(c["g"])(Object(c["E"])(e.createAt),1)])])])):"image"===e.type?(Object(c["v"])(),Object(c["e"])("div",It,[Object(c["f"])("img",{src:e.content,alt:""},null,8,Ut)])):Object(c["d"])("",!0)])):(Object(c["v"])(),Object(c["e"])("div",Nt,["text"===e.type?(Object(c["v"])(),Object(c["e"])("div",Pt,[Object(c["g"])(Object(c["E"])(e.content)+" ",1),Object(c["f"])("div",Bt,[Tt,Object(c["g"])(Object(c["E"])(e.createAt),1)])])):"image"===e.type?(Object(c["v"])(),Object(c["e"])("div",Et,[Object(c["f"])("img",{src:e.content,alt:""},null,8,qt)])):Object(c["d"])("",!0)]))]))],64)})),128))])]),Object(c["f"])("div",At,[Object(c["f"])("div",Dt,[Object(c["f"])("button",{onClick:t[0]||(t[0]=function(e){return o.openUploadModal()})},Lt),Object(c["f"])("form",{class:"",onSubmit:t[2]||(t[2]=Object(c["Q"])((function(e){return o.sendMessageFriend("text")}),["prevent"]))},[Object(c["P"])(Object(c["f"])("input",{type:"text",placeholder:"Nhập vào nội dung bạn muốn nhắn....","onUpdate:modelValue":t[1]||(t[1]=function(e){return a.inputMessageText=e})},null,512),[[c["J"],a.inputMessageText]]),Vt],32)])])])):Object(c["d"])("",!0),"chatWithStranger"===a.statusContent?(Object(c["v"])(),Object(c["e"])("div",Ht,[Object(c["f"])("div",zt,[Kt,Jt,Object(c["f"])("div",Qt,[Object(c["f"])("button",{id:"btn-newChat",style:{"margin-right":"15px"},onClick:t[3]||(t[3]=function(e){return o.connectSocketStranger()})},[Xt,Object(c["g"])(" Phòng nhắn tin mới ")]),Object(c["f"])("button",{id:"btn-stopChat",onClick:t[4]||(t[4]=function(e){return o.stopChatStranger()})},[$t,Object(c["g"])(" Kết thúc ")])])]),Object(c["f"])("div",Gt,[Object(c["f"])("div",Yt,[(Object(c["v"])(!0),Object(c["e"])(c["a"],null,Object(c["B"])(a.messagesChatWithStranger,(function(e,t){return Object(c["v"])(),Object(c["e"])(c["a"],{key:t},[t===r.messagesChatWithStranger.length-1&&t>2?(Object(c["v"])(),Object(c["e"])("div",Zt,["Người lạ"===e.name?(Object(c["v"])(),Object(c["e"])("div",en,[tn,"text"===e.type?(Object(c["v"])(),Object(c["e"])("div",nn,[Object(c["f"])("div",cn,[Object(c["f"])("div",sn,Object(c["E"])(e.name),1),Object(c["g"])(" "+Object(c["E"])(e.content)+" ",1),Object(c["f"])("div",an,[on,Object(c["g"])(Object(c["E"])(e.createAt),1)])])])):"image"===e.type?(Object(c["v"])(),Object(c["e"])("div",rn,[Object(c["f"])("img",{src:e.content,alt:""},null,8,un)])):Object(c["d"])("",!0)])):"Bot"===e.name?(Object(c["v"])(),Object(c["e"])("div",ln,[bn,Object(c["f"])("div",dn,[Object(c["f"])("div",fn,[Object(c["f"])("div",hn,Object(c["E"])(e.name),1),Object(c["g"])(" "+Object(c["E"])(e.content)+" ",1),Object(c["f"])("div",mn,[gn,Object(c["g"])(Object(c["E"])(e.createAt),1)])])])])):(Object(c["v"])(),Object(c["e"])("div",On,["text"===e.type?(Object(c["v"])(),Object(c["e"])("div",jn,[Object(c["g"])(Object(c["E"])(e.content)+" ",1),Object(c["f"])("div",pn,[vn,Object(c["g"])(Object(c["E"])(e.createAt),1)])])):"image"===e.type?(Object(c["v"])(),Object(c["e"])("div",yn,[Object(c["f"])("img",{src:e.content,alt:""},null,8,Sn)])):Object(c["d"])("",!0)]))])):(Object(c["v"])(),Object(c["e"])("div",kn,["Người lạ"===e.name?(Object(c["v"])(),Object(c["e"])("div",Cn,[xn,"text"===e.type?(Object(c["v"])(),Object(c["e"])("div",wn,[Object(c["f"])("div",Rn,[Object(c["f"])("div",_n,Object(c["E"])(e.name),1),Object(c["g"])(" "+Object(c["E"])(e.content)+" ",1),Object(c["f"])("div",Mn,[Fn,Object(c["g"])(Object(c["E"])(e.createAt),1)])])])):"image"===e.type?(Object(c["v"])(),Object(c["e"])("div",In,[Object(c["f"])("img",{src:e.content,alt:""},null,8,Un)])):Object(c["d"])("",!0)])):"Bot"===e.name?(Object(c["v"])(),Object(c["e"])("div",Nn,[Pn,Object(c["f"])("div",Bn,[Object(c["f"])("div",Tn,[Object(c["f"])("div",En,Object(c["E"])(e.name),1),Object(c["g"])(" "+Object(c["E"])(e.content)+" ",1),Object(c["f"])("div",qn,[An,Object(c["g"])(Object(c["E"])(e.createAt),1)])])])])):(Object(c["v"])(),Object(c["e"])("div",Dn,["text"===e.type?(Object(c["v"])(),Object(c["e"])("div",Wn,[Object(c["g"])(Object(c["E"])(e.content)+" ",1),Object(c["f"])("div",Ln,[Vn,Object(c["g"])(Object(c["E"])(e.createAt),1)])])):"image"===e.type?(Object(c["v"])(),Object(c["e"])("div",Hn,[Object(c["f"])("img",{src:e.content,alt:""},null,8,zn)])):Object(c["d"])("",!0)]))]))],64)})),128))])]),Object(c["f"])("div",Kn,[Object(c["f"])("button",{onClick:t[5]||(t[5]=function(e){return o.openUploadModal()}),id:"btn-sendImg"},Qn),Object(c["f"])("form",{class:"",onSubmit:t[7]||(t[7]=Object(c["Q"])((function(e){return o.sendMessageStranger("text")}),["prevent"]))},[Object(c["P"])(Object(c["f"])("input",{id:"input-sendMess",type:"text",placeholder:"Nhập vào nội dung bạn muốn nhắn....","onUpdate:modelValue":t[6]||(t[6]=function(e){return a.inputMessageTextChatWithStranger=e})},null,512),[[c["J"],a.inputMessageTextChatWithStranger]]),Xn],32)])])):Object(c["d"])("",!0),"requestContact"===a.statusContent?(Object(c["v"])(),Object(c["e"])("div",$n,[Gn,Object(c["f"])("div",Yn,[(Object(c["v"])(!0),Object(c["e"])(c["a"],null,Object(c["B"])(a.user.requestContact,(function(e,t){return Object(c["v"])(),Object(c["e"])("div",{key:t,class:"contact_item",title:e.fullName},[Object(c["f"])("img",{src:e.avatar,alt:""},null,8,ec),Object(c["f"])("div",tc,[Object(c["f"])("h3",nc,Object(c["E"])(e.fullName),1)]),Object(c["f"])("div",cc,[Object(c["f"])("button",{class:"btn btn_accept",onClick:function(t){return r.actionFriendRequest({phone:e.phone,accept:!0})}},"Chấp nhận",8,sc),Object(c["f"])("button",{class:"btn btn_deny",onClick:function(t){return r.actionFriendRequest({phone:e.phone,accept:!1})}},"Từ chối",8,ac)])],8,Zn)})),128))])])):Object(c["d"])("",!0),"contacts"===a.statusContent?(Object(c["v"])(),Object(c["e"])("div",oc,[rc,Object(c["f"])("div",ic,[(Object(c["v"])(!0),Object(c["e"])(c["a"],null,Object(c["B"])(a.user.contacts,(function(e,t){return Object(c["v"])(),Object(c["e"])("div",{key:t,class:"contact_item",title:e.fullName},[Object(c["f"])("img",{src:e.avatar,alt:""},null,8,lc),Object(c["f"])("div",bc,[Object(c["f"])("h3",dc,Object(c["E"])(e.fullName),1)])],8,uc)})),128))])])):Object(c["d"])("",!0),"notSignIn"===a.statusContent?(Object(c["v"])(),Object(c["e"])("div",fc,Oc)):Object(c["d"])("",!0),"noChatSelected"===a.statusContent?(Object(c["v"])(),Object(c["e"])("div",jc,[pc,Object(c["f"])("p",null,"Xin chào "+Object(c["E"])(this.user.fullName.substr(this.user.fullName.toString().lastIndexOf(" "))),1),vc,yc])):Object(c["d"])("",!0)],64)}var kc={name:"Content",props:{},components:{},mounted:function(){},data:function(){var e=A(),t=Object(N["c"])(e),n=t.statusContent,c=Object(N["c"])(e),s=c.chatRoomStranger,a=Object(N["c"])(e),o=a.user,r=Object(N["c"])(e),i=r.currentChatRoom;return{statusContent:n,messagesChatWithStranger:[],inputMessageTextChatWithStranger:"",url:"",chatRoomStranger:s,user:o,inputMessageText:"",currentChatRoom:i}},computed:{messages:function(){return this.currentChatRoom.messages.length>0?this.currentChatRoom.messages:[]}},watch:{statusContent:function(e,t){var n=this;"chatWithStranger"===e&&setTimeout((function(){n.chatRoomStranger?(n.disableNewChat(!1),n.disableFormInput(!1),n.disableStopChat(!1)):(n.disableNewChat(!1),n.disableFormInput(!0),n.disableStopChat(!0)),console.log(t)}),80)},messagesChatWithStranger:{deep:!0,handler:function(){console.log("hey....."),setTimeout((function(){var e=document.querySelector(".content_body");e.scrollTop=2*e.scrollHeight}),100)}}},methods:{autoSrcollTop:function(){setTimeout((function(){var e=document.querySelector(".content_body");e.scrollTop=2*e.scrollHeight}),100)},sendMessageFriend:function(e){var t,n=this;console.log("sending message...."),"text"===e&&""!==this.inputMessageText&&(t={content:this.inputMessageText,type:e,roomID:this.currentChatRoom._id}),"image"===e&&(t={content:this.url,type:e,roomID:this.currentChatRoom._id},this.url=""),W.sendMessageFriend(t,(function(e){console.log(e),n.currentChatRoom.messages.push(Object(_["a"])(Object(_["a"])({},t),{},{createAt:e.createAt,owner:n.user._id})),n.autoSrcollTop(),n.inputMessageText=""}))},openUploadModal:function(){var e=this;window.cloudinary.createUploadWidget({cloud_name:"dwnunieno",upload_preset:"ma9pfovj",maxImageFileSize:1e7,autoMinimize:!0,sources:["local"],clientAllowedFormats:["image"],maxFiles:5},(function(t,n){!t&&n&&"success"===n.event&&(console.log("Done uploading..: ",n.info),e.url=n.info.url,console.log(e.url),"000"===e.currentChatRoom._id?e.sendMessageStranger("image"):e.sendMessageFriend("image"))})).open()},connectSocketStranger:function(){var e=this;setTimeout((function(){var t=e.chatRoomStranger;console.log(t),""!==t?(e.messagesChatWithStranger=[{content:"Đang đợi người lạ ...",name:"Bot"}],e.disableNewChat(!0),e.disableFormInput(!0),e.disableStopChat(!1),W.nextRoomStranger(t)):(W.setupSocketStrangerConnection(),W.statusRoomStranger((function(t,n){if(console.log(n),"Đang đợi người lạ ..."===n.content&&(e.disableNewChat(!0),e.disableFormInput(!0),e.disableStopChat(!1)),n.content.includes("NextRoom")?(n.content="Người lạ đã rời đi. Đang đợi người lạ ...",e.disableNewChat(!0),e.disableFormInput(!0),e.disableStopChat(!1),e.setChatRoomStranger("")):e.messagesChatWithStranger.length>0&&(e.messagesChatWithStranger=[]),n.content.includes("Người lạ đã vào phòng")){var c=n.content.substr(n.content.indexOf("|")+1,n.content.length-1);e.setChatRoomStranger(c),n.content=n.content.substr(0,n.content.indexOf("|")),e.disableNewChat(!1),e.disableFormInput(!1),e.disableStopChat(!1)}"Người lạ đã rời đi. Đang đợi người lạ kế tiếp ..."===n.content&&(e.disableNewChat(!0),e.disableFormInput(!0),e.disableStopChat(!1)),e.messagesChatWithStranger.push({name:n.name,content:n.content,type:"text",createAt:n.createAt})})),W.receiveMessageStranger((function(t,n){console.log(n),e.messagesChatWithStranger.push(n)})))}),80)},sendMessageStranger:function(e){var t,n=this;console.log("sending message...."),"text"===e&&""!==this.inputMessageTextChatWithStranger&&(t={content:this.inputMessageTextChatWithStranger,type:e}),"image"===e&&(t={content:this.url,type:e},this.url=""),W.sendMessageStranger(t,(function(e){console.log(e),n.messagesChatWithStranger.push(Object(_["a"])(Object(_["a"])({},t),{},{createAt:e.createAt,name:"Me"})),n.inputMessageTextChatWithStranger=""}))},stopChatStranger:function(){var e=this;setTimeout((function(){W.disconnectStranger(),e.messagesChatWithStranger.push({type:"text",createAt:e.getTime(),content:"Bạn đã rời khỏi phòng !",name:"Bot"}),e.setChatRoomStranger(""),e.disableNewChat(!1),e.disableFormInput(!0),e.disableStopChat(!0),e.inputMessageTextChatWithStranger=""}),69),this.messagesChatWithStranger=[]},getTime:function(){var e=new Date,t=e.getDate()+"-"+(e.getMonth()+1)+"-"+e.getFullYear(),n=e.getHours()+":"+e.getMinutes(),c=n+" "+t;return c},setChatRoomStranger:function(e){A().setChatRoomStranger(e)},disableNewChat:function(e){document.querySelector("#btn-newChat").disabled=e},disableFormInput:function(e){document.querySelector("#btn-sendImg").disabled=e,document.querySelector("#btn-sendMess").disabled=e,document.querySelector("#input-sendMess").disabled=e},disableStopChat:function(e){document.querySelector("#btn-stopChat").disabled=e},actionFriendRequest:function(e){W.actionFriendRequest(e)}},beforeUnmount:function(){W.disconnectStranger(),W.disconnect()}};n("4d18");kc.render=Sc,kc.__scopeId="data-v-34844884";var Cc=kc,xc=n("4989"),wc=n.n(xc),Rc={name:"App",components:{Menu:V,Sidebar:He,Content:Cc},mounted:function(){},data:function(){var e=A(),t=Object(N["c"])(e),n=t.notifyText;return{notifyText:n,textNotify:"",flag:0}},watch:{notifyText:function(){this.textNotify=this.notifyText.toString()+this.flag.toString(),this.flag=1-this.flag,this.showNotify()}},methods:{showNotify:function(){var e=document.getElementById("liveToast"),t=new wc.a.Toast(e);t.show()}},beforeUnmount:function(){W.disconnect(),W.disconnectStranger()}};n("c4b0");Rc.render=d,Rc.__scopeId="data-v-99c93060";var _c=Rc;n("ab8b"),n("7b17"),n("845f");Object(c["c"])(_c).use(Object(N["a"])()).mount("#app")},"758e":function(e,t,n){},"845f":function(e,t,n){},c4b0:function(e,t,n){"use strict";n("758e")},e5b1:function(e,t,n){"use strict";n("0a4b")},e7ba:function(e,t,n){e.exports=n.p+"img/redi-chat.a3f95067.svg"}});
//# sourceMappingURL=app.8f2be5f2.js.map