(function(e){function t(t){for(var a,o,r=t[0],i=t[1],u=t[2],d=0,f=[];d<r.length;d++)o=r[d],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&f.push(s[o][0]),s[o]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a]);l&&l(t);while(f.length)f.shift()();return c.push.apply(c,u||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],a=!0,r=1;r<n.length;r++){var i=n[r];0!==s[i]&&(a=!1)}a&&(c.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},s={app:0},c=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/Redi/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],i=r.push.bind(r);r.push=t,r=r.slice();for(var u=0;u<r.length;u++)t(r[u]);var l=i;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0743":function(e,t,n){},"14e3":function(e,t,n){e.exports=n.p+"img/redi.10f611f2.svg"},"1e07":function(e,t,n){"use strict";n("4b54")},"24f2":function(e,t,n){"use strict";n("0743")},3778:function(e,t,n){"use strict";n("4414")},4414:function(e,t,n){},"4b54":function(e,t,n){},5058:function(e,t,n){e.exports=n.p+"img/avatar-bot.c72e65e8.png"},"527f":function(e,t,n){e.exports=n.p+"img/avatar-stranger.b0ed6063.png"},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("7a23"),s=function(e){return Object(a["z"])("data-v-7f761d93"),e=e(),Object(a["x"])(),e},c={class:"App"},o={class:"layout_main"},r={class:"toast-container",style:{position:"fixed",bottom:"10px",right:"10px"}},i={id:"liveToast",class:"toast align-items-center border-1",role:"alert","aria-live":"assertive","aria-atomic":"true"},u={class:"d-flex"},l={class:"toast-body notify-success"},d=s((function(){return Object(a["f"])("button",{type:"button",class:"btn-close btn-close-white me-2 m-auto","data-bs-dismiss":"toast","aria-label":"Close"},null,-1)}));function f(e,t,n,s,f,b){var h=Object(a["D"])("Menu"),m=Object(a["D"])("Sidebar"),g=Object(a["D"])("Content");return Object(a["w"])(),Object(a["e"])("div",c,[Object(a["f"])("div",o,[Object(a["h"])(h),Object(a["h"])(m),Object(a["h"])(g)]),Object(a["f"])("div",r,[Object(a["f"])("div",i,[Object(a["f"])("div",u,[Object(a["f"])("div",l,Object(a["F"])(this.textNotify),1),d])])])])}n("d3b7"),n("25f0");var b=n("14e3"),h=n.n(b),m=function(e){return Object(a["z"])("data-v-ff2b357e"),e=e(),Object(a["x"])(),e},g={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},p={class:"modal-dialog"},O={class:"modal-content"},j={class:"modal-header"},v=m((function(){return Object(a["f"])("h1",{class:"modal-title fs-5",id:"exampleModalLabel",style:{"align-items":"center"}},"Cập nhật thông tin",-1)})),k={class:"modal-body"},y=m((function(){return Object(a["f"])("ul",{class:"nav nav-pills mb-3",id:"pills-tab",role:"tablist"},[Object(a["f"])("li",{class:"nav-item",role:"presentation"},[Object(a["f"])("button",{class:"nav-link active",id:"pills-home-tab","data-bs-toggle":"pill","data-bs-target":"#pills-home",type:"button",role:"tab","aria-controls":"pills-home","aria-selected":"true"},"Cập nhật thông tin cơ bản")]),Object(a["f"])("li",{class:"nav-item",role:"presentation"},[Object(a["f"])("button",{class:"nav-link",id:"pills-profile-tab","data-bs-toggle":"pill","data-bs-target":"#pills-profile",type:"button",role:"tab","aria-controls":"pills-profile","aria-selected":"false"},"Đổi mật khẩu")])],-1)})),w={class:"tab-content",id:"pills-tabContent"},S={class:"tab-pane fade show active",id:"pills-home",role:"tabpanel","aria-labelledby":"pills-home-tab",tabindex:"0"},C={class:"form-group",disable:""},x=m((function(){return Object(a["f"])("label",{for:"phone"},"Số điện thoại",-1)})),M=["value"],R={class:"form-group"},F=m((function(){return Object(a["f"])("label",{for:"fullName"},"Họ và tên",-1)})),_={class:"form-group"},U=m((function(){return Object(a["f"])("label",null,"Ảnh đại diện: ",-1)})),I=m((function(){return Object(a["f"])("button",{class:"btn btn-signup"},"Cập nhật",-1)})),P={class:"tab-pane fade",id:"pills-profile",role:"tabpanel","aria-labelledby":"pills-profile-tab",tabindex:"0"},N={class:"form-group"},T=m((function(){return Object(a["f"])("label",{for:"currentPassword"},"Mật khẩu hiện tại",-1)})),q={class:"form-group"},B=m((function(){return Object(a["f"])("label",{for:"password"},"Mật Khẩu mới",-1)})),A={class:"form-group"},D=m((function(){return Object(a["f"])("label",{for:"confirmPassword"},"Xác nhận lại mật khẩu mới",-1)})),V=m((function(){return Object(a["f"])("button",{class:"btn btn-signup"},"Cập nhật",-1)})),W={class:"menu"},L={class:"menu_item"},E=["title"],H=["src"],z={key:1,src:h.a,alt:"avatar"},K=m((function(){return Object(a["f"])("div",{class:"icon-message",href:"#"},[Object(a["f"])("i",{class:"bx bxs-message-rounded-dots"})],-1)})),Q=[K],X=m((function(){return Object(a["f"])("a",{class:"icon-message"},[Object(a["f"])("i",{class:"bx bxs-contact"})],-1)})),Z=[X],$=m((function(){return Object(a["f"])("a",{class:"icon-message"},[Object(a["f"])("i",{class:"fa-sharp fa-solid fa-square-pen"})],-1)})),J=[$],G=m((function(){return Object(a["f"])("div",{class:"icon-message"},[Object(a["f"])("i",{class:"fa-solid fa-right-from-bracket"})],-1)})),Y=[G];function ee(e,t,n,s,c,o){var r=this,i=Object(a["D"])("Field"),u=Object(a["D"])("ErrorMessage"),l=Object(a["D"])("Form");return Object(a["w"])(),Object(a["e"])(a["a"],null,[Object(a["f"])("div",g,[Object(a["f"])("div",p,[Object(a["f"])("div",O,[Object(a["f"])("div",j,[v,Object(a["f"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:t[0]||(t[0]=function(e){return o.clickCloseUpdateMenu()})})]),Object(a["f"])("div",k,[y,Object(a["f"])("div",w,[Object(a["f"])("div",S,[Object(a["h"])(l,{onSubmit:t[3]||(t[3]=function(e){return o.updateInfo()}),"validation-schema":c.dataUpdateInfoFormSchema,class:"form-sign",ref:"formUpdateInfo"},{default:Object(a["P"])((function(){return[Object(a["f"])("div",C,[x,Object(a["f"])("input",{type:"text",name:"",id:"phone",value:r.user.phone,class:"form-control",disabled:""},null,8,M)]),Object(a["f"])("div",R,[F,Object(a["h"])(i,{name:"fullName",type:"text",class:"form-control",modelValue:c.dataUpdateInfo.fullName,"onUpdate:modelValue":t[1]||(t[1]=function(e){return c.dataUpdateInfo.fullName=e})},null,8,["modelValue"]),Object(a["h"])(u,{name:"fullName",class:"error-feedback"})]),Object(a["f"])("div",_,[U,Object(a["f"])("button",{type:"button",onClick:t[2]||(t[2]=function(e){return o.openUploadModal()})},Object(a["F"])(""===r.dataUpdateInfo.avatar?"Upload ảnh làm ảnh đại diện.":r.nameFileAvatar),1)]),I]})),_:1},8,["validation-schema"])]),Object(a["f"])("div",P,[Object(a["h"])(l,{onSubmit:t[7]||(t[7]=function(e){return o.changePassword()}),"validation-schema":c.dataChangePasswordFormSchema,class:"form-sign",ref:"formChangePassWord"},{default:Object(a["P"])((function(){return[Object(a["f"])("div",N,[T,Object(a["h"])(i,{name:"currentPassword",type:"password",class:"form-control",modelValue:c.dataChangePassword.currentPassword,"onUpdate:modelValue":t[4]||(t[4]=function(e){return c.dataChangePassword.currentPassword=e})},null,8,["modelValue"]),Object(a["h"])(u,{name:"currentPassword",class:"error-feedback"})]),Object(a["f"])("div",q,[B,Object(a["h"])(i,{name:"password",type:"password",class:"form-control",modelValue:c.dataChangePassword.password,"onUpdate:modelValue":t[5]||(t[5]=function(e){return c.dataChangePassword.password=e})},null,8,["modelValue"]),Object(a["h"])(u,{name:"password",class:"error-feedback"})]),Object(a["f"])("div",A,[D,Object(a["h"])(i,{name:"confirmPassword",type:"password",class:"form-control",modelValue:c.dataChangePassword.confirmPassword,"onUpdate:modelValue":t[6]||(t[6]=function(e){return c.dataChangePassword.confirmPassword=e})},null,8,["modelValue"]),Object(a["h"])(u,{name:"confirmPassword",class:"error-feedback"})]),V]})),_:1},8,["validation-schema"])])])])])])]),Object(a["f"])("ul",W,[Object(a["f"])("li",L,[Object(a["f"])("div",{class:"menu_avatar",title:this.user.fullName,href:"#"},["notSignIn"!==c.statusMenu?(Object(a["w"])(),Object(a["e"])("img",{key:0,src:this.user.avatar,alt:"avatar"},null,8,H)):(Object(a["w"])(),Object(a["e"])("img",z))],8,E)]),Object(a["f"])("li",{onClick:t[8]||(t[8]=function(e){return o.clickChatMenu()}),class:Object(a["r"])([["chat"===c.statusMenu||"notSignIn"===c.statusMenu?"active":""],"menu_item"])},Q,2),"notSignIn"!==c.statusMenu?(Object(a["w"])(),Object(a["e"])("li",{key:0,onClick:t[9]||(t[9]=function(e){return o.clickContactMenu()}),class:Object(a["r"])(["menu_item",["contacts"===c.statusMenu?"active":""]])},Z,2)):Object(a["d"])("",!0),"notSignIn"!==c.statusMenu?(Object(a["w"])(),Object(a["e"])("li",{key:1,onClick:t[10]||(t[10]=function(e){return o.clickUpdateMenu()}),"data-bs-toggle":"modal","data-bs-target":"#exampleModal",class:Object(a["r"])(["menu_item",["update"===c.statusMenu?"active":""]])},J,2)):Object(a["d"])("",!0),"notSignIn"!==c.statusMenu?(Object(a["w"])(),Object(a["e"])("li",{key:2,class:"menu_item menu_item-logout",onClick:t[11]||(t[11]=function(e){return o.signOut()})},Y)):Object(a["d"])("",!0)])],64)}var te=n("5530"),ne=n("1da1"),ae=(n("96cf"),n("d4ec")),se=n("bee2"),ce=n("ade3"),oe=n("daa8"),re=(n("159b"),n("77ba")),ie=n("cee4"),ue={headers:{"Content-Type":"application/json",Accept:"application/json"}},le=function(e){return ie["a"].create(Object(te["a"])({baseURL:e},ue))},de=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://redi-server-auth.onrender.com/api/auth";Object(ae["a"])(this,e),this.api=le(t)}return Object(se["a"])(e,[{key:"signIn",value:function(){var e=Object(ne["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.api.post("/signin",t);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"signUp",value:function(){var e=Object(ne["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.api.post("/signup",t);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"signOut",value:function(){var e=Object(ne["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.api.put("/signout",t);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"verifyToken",value:function(){var e=Object(ne["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.api.post("/getinfo",t);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),fe=new de,be=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://redi-server-auth.onrender.com/api/auth";Object(ae["a"])(this,e),this.api=le(t)}return Object(se["a"])(e,[{key:"updateInfo",value:function(){var e=Object(ne["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.api.put("/updateinfo",t);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"changePassword",value:function(){var e=Object(ne["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.api.put("/changepassword",t);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),he=new be,me=Object(re["b"])("store",{state:function(){return{statusMenu:"notSignIn",statusSidebar:"notSignIn",statusContent:"notSignIn",chatRoomStranger:"",user:{_id:"",phone:"",fullName:"",avatar:"",requestContact:[],contacts:[],chatRooms:[],token:""},currentChatRoom:{fullName:"",avatar:"",messages:[],_id:"",online:!1},foundUserByPhone:{fullName:"",_id:"",avatar:"",phone:"",sentFriendRequest:!1},notifyText:"",flag:0}},getters:{},actions:{setFoundUserByPhone:function(e){this.foundUserByPhone=e},showNotify:function(e){this.flag=1-this.flag,this.notifyText=e},clickContactMenu:function(){this.statusMenu="contacts",this.statusSidebar="contacts",this.statusContent="contacts",this.currentChatRoom={fullName:"",avatar:"",messages:[],_id:""}},clickChatMenu:function(){this.statusMenu="chat",this.statusSidebar="chat",this.statusContent="noChatSelected"},clickContactsSidebar:function(){this.statusMenu="contacts",this.statusSidebar="contacts",this.statusContent="contacts"},clickRequestContactSidebar:function(){this.statusMenu="contacts",this.statusSidebar="requestContact",this.statusContent="requestContact"},clickUpdateMenu:function(){this.statusMenu="update"},clickCloseUpdateMenu:function(){"chat"===this.statusSidebar?this.statusMenu="chat":this.statusMenu="contacts"},signOut:function(){this.statusMenu="notSignIn",this.statusSidebar="notSignIn",this.statusContent="notSignIn",this.user={_id:"",phone:"",fullName:"",avatar:"",requestContact:[],contacts:[],chatRooms:[],token:""},this.currentChatRoom={fullName:"",avatar:"",messages:[],_id:""}},chatWithStranger:function(){this.statusContent="chatWithStranger"},switchChatContent:function(){this.statusContent="chat"},setChatRoomStranger:function(e){this.chatRoomStranger=e},setInfoUser:function(e){this.user=e,this.user.token=this.user.token.toString(),localStorage.setItem("token",e.token)},changeOnlineStatus:function(e,t){var n=this.user.chatRooms.length;e===this.currentChatRoom._id&&(this.currentChatRoom.online=t);for(var a=0;a<n;a++)if(this.user.chatRooms[a]._id===e){this.user.chatRooms[a].online=t;break}},reloadData:function(){var e=this;return Object(ne["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,n=localStorage.getItem("token"),!n){t.next=10;break}return pe.disconnect(),t.next=6,fe.verifyToken({token:n});case 6:a=t.sent,a&&(e.user=a.message),pe.setupSocketFriendConnection(e.user.token,e.user.phone),pe.receiveMessageFriend((function(t,n){console.log(n),n.roomID===e.currentChatRoom._id&&(n.seen=!0,e.currentChatRoom.messages.push(n),pe.seenAllMessage(e.currentChatRoom._id),setTimeout((function(){var e=document.querySelector(".content_body");e.scrollTop=2*e.scrollHeight}),100)),e.user.chatRooms.forEach((function(t,a){if(n.roomID===t._id)return e.user.chatRooms[a].lastMessageDate=n.createAt,void(e.user.chatRooms[a].lastMessage=n)}))}));case 10:t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()},setMessagesChatRoom:function(e){this.currentChatRoom.messages=e,setTimeout((function(){var e=document.querySelector(".content_body");e.scrollTop=2*e.scrollHeight}),50)},updateMessages:function(e){console.log("updateMessages"),this.currentChatRoom._id===e&&(console.log("updating Messages"),this.currentChatRoom.messages.forEach((function(e){e.seen||(e.seen=!0)})))},updateInfo:function(e){var t=this;return Object(ne["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,he.updateInfo(e);case 3:t.user.fullName=e.fullName,t.user.avatar=e.avatar,t.showNotify("Cập nhật thông tin cơ bản thành công !"),n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](0),console.log(n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))()},changePassword:function(e){var t=this;return Object(ne["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,he.changePassword(e);case 3:t.showNotify("Cập nhật mật khẩu thành công !"),n.next=9;break;case 6:n.prev=6,n.t0=n["catch"](0),t.showNotify(n.t0.response.data.message);case 9:case"end":return n.stop()}}),n,null,[[0,6]])})))()}}}),ge=function(){function e(){Object(ae["a"])(this,e),Object(ce["a"])(this,"socketStranger",void 0),Object(ce["a"])(this,"socketFriend",void 0),Object(ce["a"])(this,"chatRoom",""),Object(ce["a"])(this,"user",void 0)}return Object(se["a"])(e,[{key:"setupSocketStrangerConnection",value:function(){var e=this;this.socketStranger=Object(oe["a"])("https://redi-server-stranger.onrender.com",{}),console.log("Connecting socket..."),this.socketStranger.on("disconnect",(function(t){"io server disconnect"===t&&e.socketStranger.connect()}))}},{key:"setupSocketFriendConnection",value:function(e,t){var n=this;this.socketFriend=Object(oe["a"])("https://redi-server-friend.onrender.com",{auth:{token:e}}),console.log("Connecting socket..."),console.log("socketFriend",this.socketFriend),this.socketFriend.on("onlineStatus",(function(e){me().changeOnlineStatus(e.roomID,e.online)})),this.socketFriend.emit("sendUser",t),this.socketFriend.on("message",(function(e){me().reloadData(),me().showNotify(e),console.log("message",e)})),this.socketFriend.on("updateMessages",(function(e){me().updateMessages(e)})),this.socketFriend.on("receiveContentChatRoom",(function(e){console.log(e),me().setMessagesChatRoom(e)})),this.socketFriend.on("disconnect",(function(e){"transport close"===e&&n.socketFriend.connect()}))}},{key:"loadContentChatRoom",value:function(e){this.socketFriend.emit("loadContentChatRoom",e)}},{key:"findUserByPhone",value:function(e){this.socketFriend.emit("findUser",e),this.socketFriend.on("foundUser",(function(e){console.log("foundUser",e),me().setFoundUserByPhone(e)}))}},{key:"actionFriendRequest",value:function(e){this.socketFriend.emit("actionFriendRequest",e)}},{key:"sendFriendRequest",value:function(e){this.socketFriend.emit("sendFriendRequest",e)}},{key:"receiveMessageFriend",value:function(e){if(!this.socketFriend)return!0;console.log("receiveMessageFriend"),this.socketFriend.on("receiveMessageFriend",(function(t){return e(null,t)}))}},{key:"sendMessageFriend",value:function(e,t){console.log(e),this.socketFriend&&this.socketFriend.emit("sendMessageFriend",e,t)}},{key:"seenAllMessage",value:function(e){console.log("seenAllMessage"),this.socketFriend&&this.socketFriend.emit("seenAllMessage",e)}},{key:"receiveMessageStranger",value:function(e){if(!this.socketStranger)return!0;this.socketStranger.on("receiveMessageStranger",(function(t){return e(null,Object(te["a"])(Object(te["a"])({},t),{},{name:"Người lạ"}))}))}},{key:"statusRoomStranger",value:function(e){if(!this.socketStranger)return!0;this.socketStranger.on("statusRoomStranger",(function(t){return e(null,Object(te["a"])(Object(te["a"])({},t),{},{name:"Bot"}))}))}},{key:"nextRoomStranger",value:function(e){this.socketStranger.emit("nextRoomStranger",e),console.log("id",this.socketStranger.id)}},{key:"sendMessageStranger",value:function(e,t){this.socketStranger&&this.socketStranger.emit("sendMessageStranger",e,t)}},{key:"disconnectStranger",value:function(){this.socketStranger&&this.socketStranger.disconnect()}},{key:"disconnect",value:function(){this.socketFriend&&this.socketFriend.disconnect()}}]),e}(),pe=new ge,Oe=n("42e9"),je=n("7bb1"),ve={name:"Menu",props:{},components:{Form:je["c"],Field:je["b"],ErrorMessage:je["a"]},mounted:function(){},data:function(){var e=me(),t=Object(re["c"])(e),n=t.statusMenu,a=Object(re["c"])(e),s=a.user,c=Oe["a"]().shape({fullName:Oe["c"]().required("Họ và tên phải có giá trị.").min(8,"Họ và tên phải ít nhất 8 ký tự.").matches("[a-zA-Z]","Họ và tên phải ít một ký tự chữ cái.").max(50,"Họ và tên có nhiều nhất 50 ký tự.")}),o=Oe["a"]().shape({currentPassword:Oe["c"]().required("Mật khẩu phải có giá trị.").min(8,"Mật khẩu phải ít nhất 8 ký tự."),password:Oe["c"]().required("Mật khẩu phải có giá trị.").min(8,"Mật khẩu phải ít nhất 8 ký tự."),confirmPassword:Oe["c"]().oneOf([Oe["b"]("password"),null],"Mật khẩu phải trùng khớp.")});return{statusMenu:n,user:s,dataChangePasswordFormSchema:o,dataUpdateInfoFormSchema:c,dataUpdateInfo:{fullName:"",avatar:""},dataChangePassword:{currentPassword:"",password:"",confirmPassword:""},nameFileAvatar:""}},watch:{user:function(){this.dataUpdateInfo.fullName=this.user.fullName}},methods:{openUploadModal:function(){var e=this,t=window.cloudinary.createUploadWidget({cloud_name:"dwnunieno",upload_preset:"ma9pfovj",maxImageFileSize:1e7,autoMinimize:!0,sources:["local"],clientAllowedFormats:["image"],maxFiles:1},function(){var n=Object(ne["a"])(regeneratorRuntime.mark((function n(a,s){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a||!s||"success"!==s.event){n.next=8;break}return console.log("Done uploading..: ",s.info),e.dataUpdateInfo.avatar=s.info.url,console.log(s.info),console.log(e.dataUpdateInfo.avatar),e.nameFileAvatar=s.info.original_filename+"."+s.info.format,n.next=8,t.destroy({removeThumbnails:!0}).then((function(){console.log("Widget was destroyed")}));case 8:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()).open()},clickContactMenu:function(){me().clickContactMenu()},clickUpdateMenu:function(){me().clickUpdateMenu()},clickChatMenu:function(){"notSignIn"!==this.statusMenu?me().clickChatMenu():alert("Bạn phải đăng nhập để thực hiện chức năng này !")},clickCloseUpdateMenu:function(){me().clickCloseUpdateMenu()},signOut:function(){var e=this;return Object(ne["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!confirm("Bạn muốn đăng xuất khỏi tài khoản này ?")){t.next=8;break}return t.next=4,fe.signOut({phone:e.user.phone});case 4:pe.disconnect(),localStorage.removeItem("token"),me().signOut(),location.reload();case 8:t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},updateInfo:function(){var e=this;return Object(ne["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""===e.dataUpdateInfo.avatar&&e.dataUpdateInfo.fullName===e.user.fullName){t.next=8;break}return""===e.dataUpdateInfo.avatar&&(e.dataUpdateInfo.avatar=e.user.avatar,e.nameFileAvatar="Ảnh đại diện hiện tại."),t.next=4,me().updateInfo(Object(te["a"])(Object(te["a"])({},e.dataUpdateInfo),{},{_id:e.user._id}));case 4:e.user.avatar=e.dataUpdateInfo.avatar,e.dataUpdateInfo.avatar="",t.next=9;break;case 8:alert("Không có thông tin mới để cập nhật !");case 9:case"end":return t.stop()}}),t)})))()},changePassword:function(){var e=this;return Object(ne["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,me().changePassword(Object(te["a"])(Object(te["a"])({},e.dataChangePassword),{},{_id:e.user._id}));case 2:setTimeout(e.$refs.formChangePassWord.resetForm,100),e.dataChangePassword={currentPassword:"",password:"",confirmPassword:""};case 4:case"end":return t.stop()}}),t)})))()}},beforeUnmount:function(){}};n("3778");ve.render=ee,ve.__scopeId="data-v-ff2b357e";var ke=ve,ye=(n("caad"),n("2532"),function(e){return Object(a["z"])("data-v-bc507e82"),e=e(),Object(a["x"])(),e}),we=ye((function(){return Object(a["f"])("div",{class:"overlay"},null,-1)})),Se={class:"modal_form-sign"},Ce=ye((function(){return Object(a["f"])("div",{class:"modal_form-sign-heading"},[Object(a["f"])("h1",null,"Đăng Ký")],-1)})),xe=ye((function(){return Object(a["f"])("div",{class:"icon-close"},[Object(a["f"])("i",{class:"bx bx-x"})],-1)})),Me={class:"form-group"},Re=ye((function(){return Object(a["f"])("label",{for:"fullName"},"Họ và tên",-1)})),Fe={class:"form-group"},_e=ye((function(){return Object(a["f"])("label",{for:"phone"},"Điện thoại",-1)})),Ue={class:"form-group"},Ie=ye((function(){return Object(a["f"])("label",{for:"password"},"Mật Khẩu",-1)})),Pe={class:"form-group"},Ne=ye((function(){return Object(a["f"])("label",{for:"confirmPassword"},"Xác nhận lại mật khẩu",-1)})),Te={class:"form-group"},qe=ye((function(){return Object(a["f"])("label",null,"Ảnh đại diện: ",-1)})),Be=ye((function(){return Object(a["f"])("button",{class:"btn btn-signup"},"Đăng ký",-1)})),Ae=ye((function(){return Object(a["f"])("div",{class:"login-signup"},[Object(a["f"])("span",{class:"text"},"Đã có tài khoản"),Object(a["f"])("span",{href:"#",class:"text login-link"},"Đăng nhập")],-1)})),De={class:"modal_form-login"},Ve=ye((function(){return Object(a["f"])("div",{class:"modal_form-sign-heading"},[Object(a["f"])("h1",null,"Đăng Nhập")],-1)})),We=ye((function(){return Object(a["f"])("div",{class:"icon-close"},[Object(a["f"])("i",{class:"bx bx-x"})],-1)})),Le={class:"form-group"},Ee=ye((function(){return Object(a["f"])("label",{for:"phone"},"Điện thoại",-1)})),He={class:"form-group"},ze=ye((function(){return Object(a["f"])("label",{for:"password"},"Mật Khẩu",-1)})),Ke=ye((function(){return Object(a["f"])("button",{class:"btn btn-signup"},"Đăng nhập",-1)})),Qe=ye((function(){return Object(a["f"])("div",{class:"login-signup"},[Object(a["f"])("span",{class:"text"},"Bạn chưa có tài khoản? Hãy chọn"),Object(a["f"])("span",{class:"text signup-link"},"Đăng ký")],-1)})),Xe={class:"sidebar"},Ze={class:"sidebar_list"},$e={key:0,class:"sidebar_item-search"},Je=ye((function(){return Object(a["f"])("i",{class:"bx bx-search"},null,-1)})),Ge=["title","onClick"],Ye=["src"],et={key:0,class:"fa-solid fa-circle"},tt={class:"sidebar_content"},nt={class:"sidebar_name"},at={key:0,class:"sidebar_message"},st={key:1,class:"sidebar_message"},ct={class:"content_body-signup"},ot=ye((function(){return Object(a["f"])("button",{href:"#",class:"btn btn-sign",id:"open-form-dangnhap1"},"Đăng Ký",-1)})),rt=ye((function(){return Object(a["f"])("button",{href:"#",class:"btn btn-log"},"Đăng Nhập",-1)})),it=ye((function(){return Object(a["f"])("div",{class:"note"},' *Bằng cách bấm vào phần "Người lạ", bạn có thể trò chuyện ngay với người lạ mà không cần Đăng nhập. ',-1)})),ut=[ot,rt,it],lt=ye((function(){return Object(a["f"])("i",{class:"bx bxs-group"},null,-1)})),dt=ye((function(){return Object(a["f"])("div",{class:"sidebar_content"},[Object(a["f"])("h3",{class:"sidebar_name"},"Danh sách bạn bè")],-1)})),ft=[lt,dt],bt=ye((function(){return Object(a["f"])("i",{class:"bx bxs-user-plus"},null,-1)})),ht=ye((function(){return Object(a["f"])("div",{class:"sidebar_content"},[Object(a["f"])("h3",{class:"sidebar_name"},"Danh sách kết bạn")],-1)})),mt=[bt,ht],gt=["title"],pt=["src"],Ot={class:"sidebar_content"},jt={class:"sidebar_name"},vt={key:1,id:"btn-requestContact",disabled:""};function kt(e,t,n,s,c,o){var r=this,i=Object(a["D"])("Field"),u=Object(a["D"])("ErrorMessage"),l=Object(a["D"])("Form");return Object(a["w"])(),Object(a["e"])(a["a"],null,[we,Object(a["f"])("div",Se,[Ce,xe,Object(a["h"])(l,{onSubmit:t[5]||(t[5]=function(e){return o.signUp()}),"validation-schema":c.dataSignUpFormSchema,class:"form-sign",ref:"formSignUp"},{default:Object(a["P"])((function(){return[Object(a["f"])("div",Me,[Re,Object(a["h"])(i,{name:"fullName",type:"text",class:"form-control",modelValue:c.dataSignUp.fullName,"onUpdate:modelValue":t[0]||(t[0]=function(e){return c.dataSignUp.fullName=e})},null,8,["modelValue"]),Object(a["h"])(u,{name:"fullName",class:"error-feedback"})]),Object(a["f"])("div",Fe,[_e,Object(a["h"])(i,{name:"phone",type:"tel",class:"form-control",modelValue:c.dataSignUp.phone,"onUpdate:modelValue":t[1]||(t[1]=function(e){return c.dataSignUp.phone=e})},null,8,["modelValue"]),Object(a["h"])(u,{name:"phone",class:"error-feedback"})]),Object(a["f"])("div",Ue,[Ie,Object(a["h"])(i,{name:"password",type:"password",class:"form-control",modelValue:c.dataSignUp.password,"onUpdate:modelValue":t[2]||(t[2]=function(e){return c.dataSignUp.password=e})},null,8,["modelValue"]),Object(a["h"])(u,{name:"password",class:"error-feedback"})]),Object(a["f"])("div",Pe,[Ne,Object(a["h"])(i,{name:"confirmPassword",type:"password",class:"form-control",modelValue:c.dataSignUp.confirmPassword,"onUpdate:modelValue":t[3]||(t[3]=function(e){return c.dataSignUp.confirmPassword=e})},null,8,["modelValue"]),Object(a["h"])(u,{name:"confirmPassword",class:"error-feedback"})]),Object(a["f"])("div",Te,[qe,Object(a["f"])("button",{type:"button",onClick:t[4]||(t[4]=function(e){return o.openUploadModal()})},Object(a["F"])(""===r.dataSignUp.avatar?"Upload ảnh làm ảnh đại diện.":r.nameFileAvatar),1)]),Be,Ae]})),_:1},8,["validation-schema"])]),Object(a["f"])("div",De,[Ve,We,Object(a["h"])(l,{onSubmit:t[8]||(t[8]=function(e){return o.signIn()}),"validation-schema":c.dataSignInFormSchema,class:"form-sign",ref:"formSignIn"},{default:Object(a["P"])((function(){return[Object(a["f"])("div",Le,[Ee,Object(a["h"])(i,{name:"phone",type:"tel",class:"form-control",modelValue:c.dataSignIn.phone,"onUpdate:modelValue":t[6]||(t[6]=function(e){return c.dataSignIn.phone=e})},null,8,["modelValue"]),Object(a["h"])(u,{name:"phone",class:"error-feedback"})]),Object(a["f"])("div",He,[ze,Object(a["h"])(i,{name:"password",type:"password",class:"form-control",modelValue:c.dataSignIn.password,"onUpdate:modelValue":t[7]||(t[7]=function(e){return c.dataSignIn.password=e})},null,8,["modelValue"]),Object(a["h"])(u,{name:"password",class:"error-feedback"})]),Ke,Qe]})),_:1},8,["validation-schema"])]),Object(a["f"])("div",Xe,[Object(a["f"])("div",Ze,["notSignIn"!==c.statusSidebar?(Object(a["w"])(),Object(a["e"])("div",$e,[Object(a["f"])("form",{onSubmit:t[10]||(t[10]=Object(a["R"])((function(e){return r.findUserByPhone()}),["prevent"]))},[Object(a["Q"])(Object(a["f"])("input",{type:"text",placeholder:"Tìm kiếm","onUpdate:modelValue":t[9]||(t[9]=function(e){return r.searchByPhone=e})},null,512),[[a["K"],this.searchByPhone]])],32),Je])):Object(a["d"])("",!0),"notSignIn"===c.statusSidebar||"chat"===c.statusSidebar?(Object(a["w"])(!0),Object(a["e"])(a["a"],{key:1},Object(a["C"])(this.chatRooms,(function(e,t){return Object(a["w"])(),Object(a["e"])("div",{key:t,class:Object(a["r"])(["sidebar_item",[e._id===r.currentChatRoom._id?"active":"",e.lastMessage?e.lastMessage.seen||e.lastMessage.sender===r.user._id?"":"new":""]]),title:e.fullNameFriend,onClick:function(t){return o.openChatContent(e)}},[Object(a["f"])("img",{src:e.avatar,alt:""},null,8,Ye),e.online?(Object(a["w"])(),Object(a["e"])("i",et)):Object(a["d"])("",!0),Object(a["f"])("div",tt,[Object(a["f"])("h3",nt,Object(a["F"])(e.fullNameFriend),1),e.lastMessage?(Object(a["w"])(),Object(a["e"])(a["a"],{key:0},["image"===e.lastMessage.type?(Object(a["w"])(),Object(a["e"])("span",at,"Hình ảnh")):(Object(a["w"])(),Object(a["e"])("span",st,Object(a["F"])(e.lastMessage.content),1))],64)):Object(a["d"])("",!0)])],10,Ge)})),128)):Object(a["d"])("",!0),Object(a["Q"])(Object(a["f"])("div",ct,ut,512),[[a["L"],"notSignIn"===c.statusSidebar]]),c.statusSidebar.includes("ontact")&&!this.checkSearchByPhone?(Object(a["w"])(),Object(a["e"])(a["a"],{key:2},[Object(a["f"])("div",{onClick:t[11]||(t[11]=function(e){return o.clickContactsSidebar()})},[Object(a["f"])("div",{class:Object(a["r"])(["sidebar_item",["contacts"===c.statusSidebar?"active":""]])},ft,2)]),Object(a["f"])("div",{onClick:t[12]||(t[12]=function(e){return o.clickRequestContactSidebar()&&!r.checkSearchByPhone})},[Object(a["f"])("div",{class:Object(a["r"])(["sidebar_item",["requestContact"===c.statusSidebar?"active":""]])},mt,2)])],64)):Object(a["d"])("",!0),this.foundUserByPhone.fullName&&this.chatRooms.length<1?(Object(a["w"])(),Object(a["e"])("div",{key:3,class:"sidebar_item",title:this.foundUserByPhone.fullName},[Object(a["f"])("img",{src:this.foundUserByPhone.avatar,alt:""},null,8,pt),Object(a["f"])("div",Ot,[Object(a["f"])("h3",jt,Object(a["F"])(this.foundUserByPhone.fullName),1)]),this.foundUserByPhone.sentFriendRequest?(Object(a["w"])(),Object(a["e"])("button",vt," Đã gửi lời mời kết bạn ")):(Object(a["w"])(),Object(a["e"])("button",{key:0,id:"btn-requestContact",onClick:t[13]||(t[13]=function(e){return o.sendFriendRequest()})}," Kết bạn "))],8,gt)):Object(a["d"])("",!0)])])],64)}n("ac1f"),n("466d"),n("d81d"),n("a15b"),n("4e82"),n("99af"),n("4de4"),n("5319");var yt={name:"Sidebar",props:{},components:{Form:je["c"],Field:je["b"],ErrorMessage:je["a"]},mounted:function(){this.processFormSignInSignUp(),this.verifyToken()},data:function(){var e=me(),t=Object(re["c"])(e),n=t.statusSidebar,a=Object(re["c"])(e),s=a.statusContent,c=Object(re["c"])(e),o=c.statusMenu,r=Object(re["c"])(e),i=r.user,u=Object(re["c"])(e),l=u.currentChatRoom,d=Object(re["c"])(e),f=d.foundUserByPhone,b=Oe["a"]().shape({fullName:Oe["c"]().required("Họ và tên phải có giá trị.").min(8,"Họ và tên phải ít nhất 8 ký tự.").matches("[a-zA-Z]","Họ và tên phải ít một ký tự chữ cái.").max(50,"Họ và tên có nhiều nhất 50 ký tự."),password:Oe["c"]().required("Mật khẩu phải có giá trị.").min(8,"Mật khẩu phải ít nhất 8 ký tự."),phone:Oe["c"]().matches(/((09|03|07|08|05)+([0-9]{8})\b)/g,"Số điện thoại không hợp lệ."),confirmPassword:Oe["c"]().oneOf([Oe["b"]("password"),null],"Mật khẩu phải trùng khớp.")}),h=Oe["a"]().shape({password:Oe["c"]().required("Mật khẩu phải có giá trị.").min(8,"Mật khẩu phải ít nhất 8 ký tự."),phone:Oe["c"]().matches(/((09|03|07|08|05)+([0-9]{8})\b)/g,"Số điện thoại không hợp lệ.")});return{statusSidebar:n,statusContent:s,statusMenu:o,dataSignUp:{phone:"",password:"",fullName:"",confirmPassword:"",avatar:""},dataSignIn:{phone:"096754253",password:"12345678"},dataSignUpFormSchema:b,dataSignInFormSchema:h,nameFileAvatar:"",user:i,searchByPhone:"",currentChatRoom:l,foundUserByPhone:f,checkSearchByPhone:!1}},watch:{searchByPhone:function(){var e=this.searchByPhone.match(/((09|03|07|08|05)+([0-9]{8})\b)/);e||(this.foundUserByPhone={fullName:"",_id:"",avatar:"",phone:"",sentFriendRequest:!1},this.checkSearchByPhone=!1)}},computed:{chatRoomsString:function(){var e=this,t=this.user.chatRooms.map((function(t){if("000"===t._id)return"";console.log(t.owner);var n,a=t.owner[0]===e.user._id?t.owner[1]:t.owner[0];return e.user.contacts.forEach((function(e){a===e._id&&(n=e.phone)})),[n,e.removeAccents(t.fullNameFriend)].join("")}));return console.log(t),t},chatRooms:function(){var e=this;if(""===this.searchByPhone){var t={_id:"000",owner:[],lastMessageDate:"0:0 0-0-0",fullNameFriend:"Người lạ",avatar:"http://res.cloudinary.com/dwnunieno/image/upload/v1679058005/sdrdzt5t2bhs5lvgsflj.png",online:!1},n=this.user.chatRooms;return n.sort(this.compareFn),[t].concat(n)}var a=this.removeAccents(this.searchByPhone),s=this.user.chatRooms.filter((function(t,n){return e.chatRoomsString[n].includes(a)})).sort(this.compareFn);return s}},methods:{removeAccents:function(e){return e=e.toLowerCase(),e=e.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a"),e=e.replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e"),e=e.replace(/ì|í|ị|ỉ|ĩ/g,"i"),e=e.replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o"),e=e.replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u"),e=e.replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y"),e=e.replace(/đ/g,"d"),e},compareFn:function(e,t){return e.lastMessageDate>t.lastMessageDate?-1:e.lastMessageDate<t.lastMessageDate?1:0},processFormSignInSignUp:function(){var e=document.querySelector(".btn-sign"),t=document.querySelector(".modal_form-sign"),n=document.querySelectorAll(".icon-close"),a=document.querySelector(".btn-log"),s=document.querySelector(".modal_form-login"),c=document.querySelector(".overlay"),o=document.querySelector(".signup-link"),r=document.querySelector(".login-link");e.addEventListener("click",(function(){t.classList.add("open"),c.classList.add("open")})),a.addEventListener("click",(function(){s.classList.add("open"),c.classList.add("open")})),n.forEach((function(e){e.addEventListener("click",(function(){t.classList.remove("open"),s.classList.remove("open"),c.classList.remove("open")}))})),o.addEventListener("click",(function(){t.classList.add("open"),s.classList.remove("open")})),r.addEventListener("click",(function(){s.classList.add("open"),t.classList.remove("open")}))},autoSrcollTop:function(){setTimeout((function(){var e=document.querySelector(".content_body");e.scrollTop=2*e.scrollHeight}),500)},verifyToken:function(){var e=this;return Object(ne["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,n=localStorage.getItem("token"),!n){t.next=7;break}return t.next=5,fe.verifyToken({token:n});case 5:a=t.sent,a&&(me().setInfoUser(a.message),pe.setupSocketFriendConnection(a.message.token,a.message.phone),pe.receiveMessageFriend((function(t,n){console.log(n),n.roomID===e.currentChatRoom._id&&(n.seen=!0,e.currentChatRoom.messages.push(n),pe.seenAllMessage(e.currentChatRoom._id),e.autoSrcollTop()),e.user.chatRooms.forEach((function(t,a){if(n.roomID===t._id)return e.user.chatRooms[a].lastMessage=n,void(e.user.chatRooms[a].lastMessageDate=n.createAt)}))})),me().clickChatMenu());case 7:t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},clickContactsSidebar:function(){me().clickContactsSidebar()},clickRequestContactSidebar:function(){me().clickRequestContactSidebar()},openChatContent:function(e){e._id!==this.currentChatRoom._id&&(this.currentChatRoom=Object(te["a"])(Object(te["a"])({},e),{},{messages:[]}),"000"===e._id?me().chatWithStranger():(pe.loadContentChatRoom(e._id.toString()),this.user.chatRooms.forEach((function(t){e._id===t._id&&t.lastMessage&&(t.lastMessage.seen=!0)})),pe.seenAllMessage(e._id),me().switchChatContent()))},openUploadModal:function(){var e=this,t=window.cloudinary.createUploadWidget({cloud_name:"dwnunieno",upload_preset:"ma9pfovj",maxImageFileSize:1e7,autoMinimize:!0,sources:["local"],clientAllowedFormats:["image"],maxFiles:1},function(){var n=Object(ne["a"])(regeneratorRuntime.mark((function n(a,s){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a||!s||"success"!==s.event){n.next=8;break}return console.log("Done uploading..: ",s.info),e.dataSignUp.avatar=s.info.url,console.log(s.info),console.log(e.dataSignUp.avatar),e.nameFileAvatar=s.info.original_filename+"."+s.info.format,n.next=8,t.destroy({removeThumbnails:!0}).then((function(){console.log("Widget was destroyed")}));case 8:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}()).open()},signUp:function(){var e=this;return Object(ne["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,""===e.dataSignUp.avatar&&(e.dataSignUp.avatar="https://res.cloudinary.com/dwnunieno/image/upload/v1678895187/ojzoerhuvkv8ealatzqz.png"),t.next=4,fe.signUp(e.dataSignUp);case 4:n=t.sent,document.querySelector(".modal_form-sign").classList.remove("open"),document.querySelector(".modal_form-login").classList.add("open"),e.dataSignUp={phone:"",password:"",fullName:"",address:"",avatar:""},setTimeout(e.$refs.formSignUp.resetForm,1500),n&&alert(n.message),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),alert(t.t0.response.data.message.toString());case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()},signIn:function(){var e=this;return Object(ne["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fe.signIn(e.dataSignIn);case 3:n=t.sent,me().setInfoUser(n.message),pe.setupSocketFriendConnection(n.message.token,n.message.phone),document.querySelector(".modal_form-login").classList.remove("open"),document.querySelector(".overlay").classList.remove("open"),me().clickChatMenu(),e.dataSignIn={phone:"",password:""},pe.receiveMessageFriend((function(t,n){console.log(n),n.roomID===e.currentChatRoom._id&&(n.seen=!0,e.currentChatRoom.messages.push(n),pe.seenAllMessage(e.currentChatRoom._id),e.autoSrcollTop()),e.user.chatRooms.forEach((function(t,a){if(n.roomID===t._id)return e.user.chatRooms[a].lastMessage=n,void(e.user.chatRooms[a].lastMessageDate=n.createAt)}))})),setTimeout(e.$refs.formSignIn.resetForm,1e3),n&&console.log(n.message),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](0),alert(t.t0.response.data.message.toString());case 18:case"end":return t.stop()}}),t,null,[[0,15]])})))()},findUserByPhone:function(){var e=this;if(!(this.chatRooms.length>0)){if(this.searchByPhone===this.user.phone)return alert(this.user.phone+" là số điện thoại của bạn mà !"),void(this.searchByPhone="");var t=this.searchByPhone.match(/((09|03|07|08|05)+([0-9]{8})\b)/);t?(this.user.requestContact.forEach((function(n){if(n.phone===e.searchByPhone)return alert('Số điện thoại: "'.concat(e.searchByPhone,'" (').concat(n.fullName,") đã gửi lời mời kết bạn cho bạn !")),e.searchByPhone="",void(t=!1)})),t&&(pe.findUserByPhone(this.searchByPhone),this.checkSearchByPhone=!0,console.log(this.searchByPhone),this.currentChatRoom={fullName:"",avatar:"",messages:[],_id:""},this.statusContent="noChatSelected")):alert('Số điện thoại: "'.concat(this.searchByPhone,'" chưa hợp lệ !'))}},sendFriendRequest:function(){pe.sendFriendRequest(this.foundUserByPhone.phone),this.searchByPhone="",this.foundUserByPhone={fullName:"",_id:"",avatar:"",phone:"",sentFriendRequest:!1},this.statusSidebar="chat",this.statusMenu="chat"}},beforeUnmount:function(){}};n("b437");yt.render=kt,yt.__scopeId="data-v-bc507e82";var wt=yt,St=(n("b0c0"),n("527f")),Ct=n.n(St),xt=n("5058"),Mt=n.n(xt),Rt=n("e7ba"),Ft=n.n(Rt),_t=function(e){return Object(a["z"])("data-v-6363a379"),e=e(),Object(a["x"])(),e},Ut={key:0,class:"content"},It={class:"content_header"},Pt=["src"],Nt={key:0,class:"fa-solid fa-circle"},Tt={class:"content_header-title"},qt={class:"content_body"},Bt={class:"chat-box"},At={key:0},Dt={key:0,class:"mess-incoming"},Vt={class:"mess-avatar"},Wt=["src"],Lt={key:0,class:"details",style:{"margin-bottom":"10px"}},Et={class:"mess-text"},Ht={class:"mess-name"},zt={class:"mess-time"},Kt=_t((function(){return Object(a["f"])("br",null,null,-1)})),Qt={key:1,class:"mess-img",style:{"margin-bottom":"10px"}},Xt=["src"],Zt={key:1,class:"mess-outgoing"},$t=["title"],Jt={class:"mess-time"},Gt=_t((function(){return Object(a["f"])("br",null,null,-1)})),Yt=["title"],en=["src"],tn={key:2,class:"mess-seen"},nn=["src"],an={key:1},sn={key:0,class:"mess-incoming"},cn={class:"mess-avatar"},on=["src"],rn={key:0,class:"details"},un={class:"mess-text"},ln={class:"mess-name"},dn={class:"mess-time"},fn=_t((function(){return Object(a["f"])("br",null,null,-1)})),bn={key:1,class:"mess-img",style:{"margin-bottom":"10px"}},hn=["src"],mn={key:1,class:"mess-outgoing"},gn=["title"],pn={class:"mess-time"},On=_t((function(){return Object(a["f"])("br",null,null,-1)})),jn=["title"],vn=["src"],kn={key:2,class:"mess-seen"},yn=["src"],wn={class:"chat-footer"},Sn={class:"chat-footer"},Cn=_t((function(){return Object(a["f"])("i",{class:"fa-solid fa-image"},null,-1)})),xn=[Cn],Mn=_t((function(){return Object(a["f"])("button",{type:"submit"},[Object(a["f"])("i",{class:"fa-solid fa-paper-plane"})],-1)})),Rn={key:1,class:"content"},Fn={class:"content_header"},_n=_t((function(){return Object(a["f"])("img",{class:"content_header-img",src:Ct.a,alt:""},null,-1)})),Un=_t((function(){return Object(a["f"])("div",{class:"content_header-title"},[Object(a["f"])("h1",null,"Người lạ")],-1)})),In={class:"content_header-right"},Pn=_t((function(){return Object(a["f"])("i",{class:"fa-solid fa-comment-medical"},null,-1)})),Nn=_t((function(){return Object(a["f"])("i",{class:"fa-solid fa-comment-slash"},null,-1)})),Tn={class:"content_body"},qn={class:"chat-box"},Bn={key:0},An={key:0,class:"mess-incoming"},Dn=_t((function(){return Object(a["f"])("div",{class:"mess-avatar"},[Object(a["f"])("img",{src:Ct.a,alt:""})],-1)})),Vn={key:0,class:"details",style:{"margin-bottom":"10px"}},Wn={class:"mess-text"},Ln={class:"mess-name"},En={class:"mess-time"},Hn=_t((function(){return Object(a["f"])("br",null,null,-1)})),zn={key:1,class:"mess-img"},Kn=["src"],Qn={key:1,class:"mess-incoming"},Xn=_t((function(){return Object(a["f"])("div",{class:"mess-avatar"},[Object(a["f"])("img",{src:Mt.a,alt:""})],-1)})),Zn={class:"details"},$n={class:"mess-text",style:{"margin-bottom":"10px"}},Jn={class:"mess-name"},Gn={class:"mess-time"},Yn=_t((function(){return Object(a["f"])("br",null,null,-1)})),ea={key:2,class:"mess-outgoing"},ta={key:0,class:"mess-text",style:{"margin-bottom":"10px"}},na={class:"mess-time"},aa=_t((function(){return Object(a["f"])("br",null,null,-1)})),sa={key:1,class:"mess-img"},ca=["src"],oa={key:1},ra={key:0,class:"mess-incoming"},ia=_t((function(){return Object(a["f"])("div",{class:"mess-avatar"},[Object(a["f"])("img",{src:Ct.a,alt:""})],-1)})),ua={key:0,class:"details"},la={class:"mess-text"},da={class:"mess-name"},fa={class:"mess-time"},ba=_t((function(){return Object(a["f"])("br",null,null,-1)})),ha={key:1,class:"mess-img"},ma=["src"],ga={key:1,class:"mess-incoming"},pa=_t((function(){return Object(a["f"])("div",{class:"mess-avatar"},[Object(a["f"])("img",{src:Mt.a,alt:""})],-1)})),Oa={class:"details"},ja={class:"mess-text"},va={class:"mess-name"},ka={class:"mess-time"},ya=_t((function(){return Object(a["f"])("br",null,null,-1)})),wa={key:2,class:"mess-outgoing"},Sa={key:0,class:"mess-text"},Ca={class:"mess-time"},xa=_t((function(){return Object(a["f"])("br",null,null,-1)})),Ma={key:1,class:"mess-img"},Ra=["src"],Fa={class:"chat-footer"},_a=_t((function(){return Object(a["f"])("i",{class:"fa-solid fa-image"},null,-1)})),Ua=[_a],Ia=_t((function(){return Object(a["f"])("button",{id:"btn-sendMess",type:"submit"},[Object(a["f"])("i",{class:"fa-solid fa-paper-plane"})],-1)})),Pa={key:2,class:"contact_main"},Na=_t((function(){return Object(a["f"])("div",{class:"content_header"},[Object(a["f"])("i",{class:"bx bxs-user-plus"}),Object(a["f"])("div",{class:"content_header-title"},[Object(a["f"])("h1",null,"Danh sách kết bạn")])],-1)})),Ta={class:"contact_list"},qa=["title"],Ba=["src"],Aa={class:"contact_content"},Da={class:"contact_name"},Va={class:"contact_action"},Wa=["onClick"],La=["onClick"],Ea={key:3,class:"contact_main"},Ha=_t((function(){return Object(a["f"])("div",{class:"content_header"},[Object(a["f"])("i",{class:"bx bxs-group"}),Object(a["f"])("div",{class:"content_header-title"},[Object(a["f"])("h1",null,"Danh sách bạn bè")])],-1)})),za={class:"contact_list"},Ka=["title"],Qa=["src"],Xa={class:"contact_content"},Za={class:"contact_name"},$a={key:4,class:"contact_main introduce"},Ja=_t((function(){return Object(a["f"])("img",{src:Ft.a,alt:""},null,-1)})),Ga=_t((function(){return Object(a["f"])("h1",null,"REDI",-1)})),Ya=_t((function(){return Object(a["f"])("h2",null,"XOÁ NHOÀ KHOẢNG CÁCH",-1)})),es=[Ja,Ga,Ya],ts={key:5,class:"contact_main no-chat-selected"},ns=_t((function(){return Object(a["f"])("img",{src:Ft.a,alt:""},null,-1)})),as=_t((function(){return Object(a["f"])("p",null,"chào mừng bạn đến với REDI, ",-1)})),ss=_t((function(){return Object(a["f"])("p",null,"bắt đầu trò chuyện với những người mà bạn yêu thương nào !",-1)}));function cs(e,t,n,s,c,o){var r=this;return Object(a["w"])(),Object(a["e"])(a["a"],null,["chat"===c.statusContent?(Object(a["w"])(),Object(a["e"])("div",Ut,[Object(a["f"])("div",It,[Object(a["f"])("img",{class:"content_header-img",src:this.currentChatRoom.avatar,alt:""},null,8,Pt),Object(a["f"])("span",null,[this.currentChatRoom.online?(Object(a["w"])(),Object(a["e"])("i",Nt)):Object(a["d"])("",!0)]),Object(a["f"])("div",Tt,[Object(a["f"])("h1",null,Object(a["F"])(this.currentChatRoom.fullNameFriend),1)])]),Object(a["f"])("div",qt,[Object(a["f"])("div",Bt,[(Object(a["w"])(!0),Object(a["e"])(a["a"],null,Object(a["C"])(this.messages,(function(e,t){return Object(a["w"])(),Object(a["e"])(a["a"],{key:t},[t===r.currentChatRoom.messages.length-1&&t>2?(Object(a["w"])(),Object(a["e"])("div",At,[e.sender!==r.user._id?(Object(a["w"])(),Object(a["e"])("div",Dt,[Object(a["f"])("div",Vt,[Object(a["f"])("img",{src:r.currentChatRoom.avatar,alt:""},null,8,Wt)]),"text"===e.type?(Object(a["w"])(),Object(a["e"])("div",Lt,[Object(a["f"])("div",Et,[Object(a["f"])("div",Ht,Object(a["F"])(r.currentChatRoom.fullNameFriend),1),Object(a["g"])(" "+Object(a["F"])(e.content)+" ",1),Object(a["f"])("div",zt,[Kt,Object(a["g"])(Object(a["F"])(o.formatTime(e.createAt)),1)])])])):"image"===e.type?(Object(a["w"])(),Object(a["e"])("div",Qt,[Object(a["f"])("img",{src:e.content,alt:""},null,8,Xt)])):Object(a["d"])("",!0)])):(Object(a["w"])(),Object(a["e"])("div",Zt,["text"===e.type?(Object(a["w"])(),Object(a["e"])("div",{key:0,class:"mess-text",style:Object(a["s"])([t!==r.lastSeenMessage?"margin-bottom: 10px;":""]),title:[e.seen?"Đã xem":"Đã gửi"]},[Object(a["g"])(Object(a["F"])(e.content)+" ",1),Object(a["f"])("div",Jt,[Gt,Object(a["g"])(Object(a["F"])(o.formatTime(e.createAt)),1)])],12,$t)):"image"===e.type?(Object(a["w"])(),Object(a["e"])("div",{key:1,class:"mess-img",style:Object(a["s"])([t!==r.lastSeenMessage?"margin-bottom: 10px;":""]),title:[e.seen?"Đã xem":"Đã gửi"]},[Object(a["f"])("img",{src:e.content,alt:""},null,8,en)],12,Yt)):Object(a["d"])("",!0)])),t===r.lastSeenMessage?(Object(a["w"])(),Object(a["e"])("div",tn,[Object(a["f"])("img",{src:r.currentChatRoom.avatar,alt:""},null,8,nn)])):Object(a["d"])("",!0)])):(Object(a["w"])(),Object(a["e"])("div",an,[e.sender!==r.user._id?(Object(a["w"])(),Object(a["e"])("div",sn,[Object(a["f"])("div",cn,[Object(a["f"])("img",{src:r.currentChatRoom.avatar,alt:""},null,8,on)]),"text"===e.type?(Object(a["w"])(),Object(a["e"])("div",rn,[Object(a["f"])("div",un,[Object(a["f"])("div",ln,Object(a["F"])(r.currentChatRoom.fullNameFriend),1),Object(a["g"])(" "+Object(a["F"])(e.content)+" ",1),Object(a["f"])("div",dn,[fn,Object(a["g"])(Object(a["F"])(o.formatTime(e.createAt)),1)])])])):"image"===e.type?(Object(a["w"])(),Object(a["e"])("div",bn,[Object(a["f"])("img",{src:e.content,alt:""},null,8,hn)])):Object(a["d"])("",!0)])):(Object(a["w"])(),Object(a["e"])("div",mn,["text"===e.type?(Object(a["w"])(),Object(a["e"])("div",{key:0,class:"mess-text",title:[e.seen?"Đã xem":"Đã gửi"]},[Object(a["g"])(Object(a["F"])(e.content)+" ",1),Object(a["f"])("div",pn,[On,Object(a["g"])(Object(a["F"])(o.formatTime(e.createAt)),1)])],8,gn)):"image"===e.type?(Object(a["w"])(),Object(a["e"])("div",{key:1,class:"mess-img",style:{"margin-bottom":"10px"},title:[e.seen?"Đã xem":"Đã gửi"]},[Object(a["f"])("img",{src:e.content,alt:""},null,8,vn)],8,jn)):Object(a["d"])("",!0)])),t===r.lastSeenMessage?(Object(a["w"])(),Object(a["e"])("div",kn,[Object(a["f"])("img",{src:r.currentChatRoom.avatar,alt:""},null,8,yn)])):Object(a["d"])("",!0)]))],64)})),128))])]),Object(a["f"])("div",wn,[Object(a["f"])("div",Sn,[Object(a["f"])("button",{onClick:t[0]||(t[0]=function(e){return o.openUploadModal()})},xn),Object(a["f"])("form",{class:"",onSubmit:t[2]||(t[2]=Object(a["R"])((function(e){return o.sendMessageFriend("text")}),["prevent"]))},[Object(a["Q"])(Object(a["f"])("input",{type:"text",placeholder:"Nhập vào nội dung bạn muốn nhắn....","onUpdate:modelValue":t[1]||(t[1]=function(e){return c.inputMessageText=e})},null,512),[[a["K"],c.inputMessageText]]),Mn],32)])])])):Object(a["d"])("",!0),"chatWithStranger"===c.statusContent?(Object(a["w"])(),Object(a["e"])("div",Rn,[Object(a["f"])("div",Fn,[_n,Un,Object(a["f"])("div",In,[Object(a["f"])("button",{id:"btn-newChat",style:{"margin-right":"15px"},onClick:t[3]||(t[3]=function(e){return o.connectSocketStranger()})},[Pn,Object(a["g"])(" Phòng nhắn tin mới ")]),Object(a["f"])("button",{id:"btn-stopChat",onClick:t[4]||(t[4]=function(e){return o.stopChatStranger()})},[Nn,Object(a["g"])(" Kết thúc ")])])]),Object(a["f"])("div",Tn,[Object(a["f"])("div",qn,[(Object(a["w"])(!0),Object(a["e"])(a["a"],null,Object(a["C"])(c.messagesChatWithStranger,(function(e,t){return Object(a["w"])(),Object(a["e"])(a["a"],{key:t},[t===r.messagesChatWithStranger.length-1&&t>2?(Object(a["w"])(),Object(a["e"])("div",Bn,["Người lạ"===e.name?(Object(a["w"])(),Object(a["e"])("div",An,[Dn,"text"===e.type?(Object(a["w"])(),Object(a["e"])("div",Vn,[Object(a["f"])("div",Wn,[Object(a["f"])("div",Ln,Object(a["F"])(e.name),1),Object(a["g"])(" "+Object(a["F"])(e.content)+" ",1),Object(a["f"])("div",En,[Hn,Object(a["g"])(Object(a["F"])(o.formatTime(e.createAt)),1)])])])):"image"===e.type?(Object(a["w"])(),Object(a["e"])("div",zn,[Object(a["f"])("img",{src:e.content,alt:""},null,8,Kn)])):Object(a["d"])("",!0)])):"Bot"===e.name?(Object(a["w"])(),Object(a["e"])("div",Qn,[Xn,Object(a["f"])("div",Zn,[Object(a["f"])("div",$n,[Object(a["f"])("div",Jn,Object(a["F"])(e.name),1),Object(a["g"])(" "+Object(a["F"])(e.content)+" ",1),Object(a["f"])("div",Gn,[Yn,Object(a["g"])(Object(a["F"])(o.formatTime(e.createAt)),1)])])])])):(Object(a["w"])(),Object(a["e"])("div",ea,["text"===e.type?(Object(a["w"])(),Object(a["e"])("div",ta,[Object(a["g"])(Object(a["F"])(e.content)+" ",1),Object(a["f"])("div",na,[aa,Object(a["g"])(Object(a["F"])(o.formatTime(e.createAt)),1)])])):"image"===e.type?(Object(a["w"])(),Object(a["e"])("div",sa,[Object(a["f"])("img",{src:e.content,alt:""},null,8,ca)])):Object(a["d"])("",!0)]))])):(Object(a["w"])(),Object(a["e"])("div",oa,["Người lạ"===e.name?(Object(a["w"])(),Object(a["e"])("div",ra,[ia,"text"===e.type?(Object(a["w"])(),Object(a["e"])("div",ua,[Object(a["f"])("div",la,[Object(a["f"])("div",da,Object(a["F"])(e.name),1),Object(a["g"])(" "+Object(a["F"])(e.content)+" ",1),Object(a["f"])("div",fa,[ba,Object(a["g"])(Object(a["F"])(o.formatTime(e.createAt)),1)])])])):"image"===e.type?(Object(a["w"])(),Object(a["e"])("div",ha,[Object(a["f"])("img",{src:e.content,alt:""},null,8,ma)])):Object(a["d"])("",!0)])):"Bot"===e.name?(Object(a["w"])(),Object(a["e"])("div",ga,[pa,Object(a["f"])("div",Oa,[Object(a["f"])("div",ja,[Object(a["f"])("div",va,Object(a["F"])(e.name),1),Object(a["g"])(" "+Object(a["F"])(e.content)+" ",1),Object(a["f"])("div",ka,[ya,Object(a["g"])(Object(a["F"])(o.formatTime(e.createAt)),1)])])])])):(Object(a["w"])(),Object(a["e"])("div",wa,["text"===e.type?(Object(a["w"])(),Object(a["e"])("div",Sa,[Object(a["g"])(Object(a["F"])(e.content)+" ",1),Object(a["f"])("div",Ca,[xa,Object(a["g"])(Object(a["F"])(o.formatTime(e.createAt)),1)])])):"image"===e.type?(Object(a["w"])(),Object(a["e"])("div",Ma,[Object(a["f"])("img",{src:e.content,alt:""},null,8,Ra)])):Object(a["d"])("",!0)]))]))],64)})),128))])]),Object(a["f"])("div",Fa,[Object(a["f"])("button",{onClick:t[5]||(t[5]=function(e){return o.openUploadModal()}),id:"btn-sendImg"},Ua),Object(a["f"])("form",{class:"",onSubmit:t[7]||(t[7]=Object(a["R"])((function(e){return o.sendMessageStranger("text")}),["prevent"]))},[Object(a["Q"])(Object(a["f"])("input",{id:"input-sendMess",type:"text",placeholder:"Nhập vào nội dung bạn muốn nhắn....","onUpdate:modelValue":t[6]||(t[6]=function(e){return c.inputMessageTextChatWithStranger=e})},null,512),[[a["K"],c.inputMessageTextChatWithStranger]]),Ia],32)])])):Object(a["d"])("",!0),"requestContact"===c.statusContent?(Object(a["w"])(),Object(a["e"])("div",Pa,[Na,Object(a["f"])("div",Ta,[(Object(a["w"])(!0),Object(a["e"])(a["a"],null,Object(a["C"])(c.user.requestContact,(function(e,t){return Object(a["w"])(),Object(a["e"])("div",{key:t,class:"contact_item",title:e.fullName},[Object(a["f"])("img",{src:e.avatar,alt:""},null,8,Ba),Object(a["f"])("div",Aa,[Object(a["f"])("h3",Da,Object(a["F"])(e.fullName),1)]),Object(a["f"])("div",Va,[Object(a["f"])("button",{class:"btn btn_accept",onClick:function(t){return r.actionFriendRequest({phone:e.phone,accept:!0})}},"Chấp nhận",8,Wa),Object(a["f"])("button",{class:"btn btn_deny",onClick:function(t){return r.actionFriendRequest({phone:e.phone,accept:!1})}},"Từ chối",8,La)])],8,qa)})),128))])])):Object(a["d"])("",!0),"contacts"===c.statusContent?(Object(a["w"])(),Object(a["e"])("div",Ea,[Ha,Object(a["f"])("div",za,[(Object(a["w"])(!0),Object(a["e"])(a["a"],null,Object(a["C"])(c.user.contacts,(function(e,t){return Object(a["w"])(),Object(a["e"])("div",{key:t,class:"contact_item",title:e.fullName},[Object(a["f"])("img",{src:e.avatar,alt:""},null,8,Qa),Object(a["f"])("div",Xa,[Object(a["f"])("h3",Za,Object(a["F"])(e.fullName),1)])],8,Ka)})),128))])])):Object(a["d"])("",!0),"notSignIn"===c.statusContent?(Object(a["w"])(),Object(a["e"])("div",$a,es)):Object(a["d"])("",!0),"noChatSelected"===c.statusContent?(Object(a["w"])(),Object(a["e"])("div",ts,[ns,Object(a["f"])("p",null,"Xin chào "+Object(a["F"])(this.user.fullName.substr(this.user.fullName.toString().lastIndexOf(" "))),1),as,ss])):Object(a["d"])("",!0)],64)}n("1276");var os={name:"Content",props:{},components:{},mounted:function(){},data:function(){var e=me(),t=Object(re["c"])(e),n=t.statusContent,a=Object(re["c"])(e),s=a.chatRoomStranger,c=Object(re["c"])(e),o=c.user,r=Object(re["c"])(e),i=r.currentChatRoom;return{statusContent:n,messagesChatWithStranger:[],inputMessageTextChatWithStranger:"",url:"",chatRoomStranger:s,user:o,inputMessageText:"",currentChatRoom:i}},computed:{messages:function(){return this.currentChatRoom.messages.length>0?this.currentChatRoom.messages:[]},lastSeenMessage:function(){if(this.currentChatRoom.messages.length>0)for(var e=this.currentChatRoom.messages.length-1;e>=0;e--)if(this.currentChatRoom.messages[e].sender===this.user._id&&this.currentChatRoom.messages[e].seen)return e;return-1}},watch:{statusContent:function(e,t){var n=this;"chatWithStranger"===e&&setTimeout((function(){n.chatRoomStranger?(n.disableNewChat(!1),n.disableFormInput(!1),n.disableStopChat(!1)):(n.disableNewChat(!1),n.disableFormInput(!0),n.disableStopChat(!0)),console.log(t)}),80)},messagesChatWithStranger:{deep:!0,handler:function(){console.log("hey....."),setTimeout((function(){var e=document.querySelector(".content_body");e.scrollTop=2*e.scrollHeight}),100)}}},methods:{autoSrcollTop:function(){setTimeout((function(){var e=document.querySelector(".content_body");e.scrollTop=2*e.scrollHeight}),100)},sendMessageFriend:function(e){var t,n=this;e&&("text"===e&&""!==this.inputMessageText&&(t={content:this.inputMessageText,type:e,roomID:this.currentChatRoom._id}),"image"===e&&(t={content:this.url,type:e,roomID:this.currentChatRoom._id},this.url=""),t&&(console.log("sending message...."),pe.sendMessageFriend(t,(function(e){console.log(e),n.currentChatRoom.messages.push(Object(te["a"])(Object(te["a"])({},t),{},{createAt:e.createAt,sender:n.user._id,seen:!1})),n.autoSrcollTop(),n.inputMessageText=""}))))},openUploadModal:function(){var e=this;window.cloudinary.createUploadWidget({cloud_name:"dwnunieno",upload_preset:"ma9pfovj",maxImageFileSize:1e7,autoMinimize:!0,sources:["local"],clientAllowedFormats:["image"],maxFiles:5},(function(t,n){!t&&n&&"success"===n.event&&(console.log("Done uploading..: ",n.info),e.url=n.info.url,console.log(e.url),"000"===e.currentChatRoom._id?e.sendMessageStranger("image"):e.sendMessageFriend("image"))})).open()},connectSocketStranger:function(){var e=this;setTimeout((function(){var t=e.chatRoomStranger;console.log(t),""!==t?(e.messagesChatWithStranger=[{content:"Đang đợi người lạ ...",name:"Bot"}],e.disableNewChat(!0),e.disableFormInput(!0),e.disableStopChat(!1),pe.nextRoomStranger(t)):(pe.setupSocketStrangerConnection(),pe.statusRoomStranger((function(t,n){if(console.log(n),"Đang đợi người lạ ..."===n.content&&(e.disableNewChat(!0),e.disableFormInput(!0),e.disableStopChat(!1)),n.content.includes("NextRoom")?(n.content="Người lạ đã rời đi. Đang đợi người lạ ...",e.disableNewChat(!0),e.disableFormInput(!0),e.disableStopChat(!1),e.setChatRoomStranger("")):e.messagesChatWithStranger.length>0&&(e.messagesChatWithStranger=[]),n.content.includes("Người lạ đã vào phòng")){var a=n.content.substr(n.content.indexOf("|")+1,n.content.length-1);e.setChatRoomStranger(a),n.content=n.content.substr(0,n.content.indexOf("|")),e.disableNewChat(!1),e.disableFormInput(!1),e.disableStopChat(!1)}"Người lạ đã rời đi. Đang đợi người lạ kế tiếp ..."===n.content&&(e.disableNewChat(!0),e.disableFormInput(!0),e.disableStopChat(!1)),e.messagesChatWithStranger.push({name:n.name,content:n.content,type:"text",createAt:n.createAt})})),pe.receiveMessageStranger((function(t,n){console.log(n),e.messagesChatWithStranger.push(n)})))}),80)},sendMessageStranger:function(e){var t,n=this;e&&("text"===e&&""!==this.inputMessageTextChatWithStranger&&(t={content:this.inputMessageTextChatWithStranger,type:e}),"image"===e&&(t={content:this.url,type:e},this.url=""),t&&pe.sendMessageStranger(t,(function(e){console.log(e),n.messagesChatWithStranger.push(Object(te["a"])(Object(te["a"])({},t),{},{createAt:e.createAt,name:"Me"})),n.inputMessageTextChatWithStranger=""})))},stopChatStranger:function(){var e=this;setTimeout((function(){pe.disconnectStranger(),e.messagesChatWithStranger.push({type:"text",createAt:e.getTime(),content:"Bạn đã rời khỏi phòng !",name:"Bot"}),e.setChatRoomStranger(""),e.disableNewChat(!1),e.disableFormInput(!0),e.disableStopChat(!0),e.inputMessageTextChatWithStranger=""}),69),this.messagesChatWithStranger=[]},getTime:function(){var e=new Date,t=e.getTime()+6e4*e.getTimezoneOffset(),n=7,a=new Date(t+36e5*(n-e.getTimezoneOffset()/60));return a},formatTime:function(e){var t=e;return"string"===typeof e&&(t=new Date(e)),t=t.toLocaleString("vi-VN",{timeZone:"UTC"}).split(" "),t[0].substr(0,t[0].lastIndexOf(":"))+" "+t[1]},setChatRoomStranger:function(e){me().setChatRoomStranger(e)},disableNewChat:function(e){document.querySelector("#btn-newChat").disabled=e},disableFormInput:function(e){document.querySelector("#btn-sendImg").disabled=e,document.querySelector("#btn-sendMess").disabled=e,document.querySelector("#input-sendMess").disabled=e},disableStopChat:function(e){document.querySelector("#btn-stopChat").disabled=e},actionFriendRequest:function(e){pe.actionFriendRequest(e)}},beforeUnmount:function(){pe.disconnectStranger(),pe.disconnect()}};n("24f2");os.render=cs,os.__scopeId="data-v-6363a379";var rs=os,is=n("4989"),us=n.n(is),ls={name:"App",components:{Menu:ke,Sidebar:wt,Content:rs},mounted:function(){},data:function(){var e=me(),t=Object(re["c"])(e),n=t.notifyText,a=Object(re["c"])(e),s=a.flag;return{notifyText:n,flag:s,textNotify:""}},watch:{flag:function(){this.textNotify=this.notifyText.toString(),this.showNotify()}},methods:{showNotify:function(){var e=document.getElementById("liveToast"),t=new us.a.Toast(e);t.show()},test:function(){var e=this;setInterval((function(){e.showNotify()}),1e3)}},beforeUnmount:function(){pe.disconnect(),pe.disconnectStranger()}};n("1e07");ls.render=f,ls.__scopeId="data-v-7f761d93";var ds=ls;n("ab8b"),n("7b17"),n("845f");Object(a["c"])(ds).use(Object(re["a"])()).mount("#app")},"845f":function(e,t,n){},b437:function(e,t,n){"use strict";n("cf73")},cf73:function(e,t,n){},e7ba:function(e,t,n){e.exports=n.p+"img/redi-chat.a3f95067.svg"}});
//# sourceMappingURL=app.155652e8.js.map