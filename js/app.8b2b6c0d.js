(function(e){function t(t){for(var a,r,o=t[0],i=t[1],u=t[2],d=0,f=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&f.push(s[r][0]),s[r]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a]);l&&l(t);while(f.length)f.shift()();return c.push.apply(c,u||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],a=!0,o=1;o<n.length;o++){var i=n[o];0!==s[i]&&(a=!1)}a&&(c.splice(t--,1),e=r(r.s=n[0]))}return e}var a={},s={app:0},c=[];function r(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=a,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/Redi/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],i=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=i;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0574":function(e,t,n){"use strict";n("8702")},"14e3":function(e,t,n){e.exports=n.p+"img/redi.10f611f2.svg"},"1b35":function(e,t,n){"use strict";n("c6cf")},2749:function(e,t,n){"use strict";n("6b26")},5058:function(e,t,n){e.exports=n.p+"img/avatar-bot.c72e65e8.png"},"527f":function(e,t,n){e.exports=n.p+"img/avatar-stranger.b0ed6063.png"},5598:function(e,t,n){"use strict";n("5d33")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("7a23"),s=function(e){return Object(a["y"])("data-v-6ab2c8c6"),e=e(),Object(a["w"])(),e},c={class:"App"},r={class:"layout_main"},o={class:"toast-container",style:{position:"fixed",bottom:"60px",right:"10px"}},i={id:"liveToast",class:"toast align-items-center border-1",role:"alert","aria-live":"assertive","aria-atomic":"true"},u={class:"d-flex"},l={class:"toast-body notify-success"},d=s((function(){return Object(a["f"])("button",{type:"button",class:"btn-close btn-close-white me-2 m-auto","data-bs-dismiss":"toast","aria-label":"Close"},null,-1)}));function f(e,t,n,s,f,h){var b=Object(a["C"])("Menu"),m=Object(a["C"])("Sidebar"),p=Object(a["C"])("Content");return Object(a["v"])(),Object(a["e"])("div",c,[Object(a["f"])("div",r,[Object(a["h"])(b),Object(a["h"])(m),Object(a["h"])(p)]),Object(a["f"])("div",o,[Object(a["f"])("div",i,[Object(a["f"])("div",u,[Object(a["f"])("div",l,Object(a["E"])(this.textNotify),1),d])])])])}n("d3b7"),n("25f0");var h=n("14e3"),b=n.n(h),m=function(e){return Object(a["y"])("data-v-5cb4f6e2"),e=e(),Object(a["w"])(),e},p={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},g={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable"},O={class:"modal-content"},j={class:"modal-header"},v=m((function(){return Object(a["f"])("h1",{class:"modal-title fs-5",id:"exampleModalLabel",style:{"align-items":"center"}},"Cập nhật thông tin",-1)})),k={class:"modal-body"},S=m((function(){return Object(a["f"])("ul",{class:"nav nav-pills mb-3",id:"pills-tab",role:"tablist"},[Object(a["f"])("li",{class:"nav-item",role:"presentation"},[Object(a["f"])("button",{class:"nav-link active",id:"pills-home-tab","data-bs-toggle":"pill","data-bs-target":"#pills-home",type:"button",role:"tab","aria-controls":"pills-home","aria-selected":"true"},"Cập nhật thông tin cơ bản")]),Object(a["f"])("li",{class:"nav-item",role:"presentation"},[Object(a["f"])("button",{class:"nav-link",id:"pills-profile-tab","data-bs-toggle":"pill","data-bs-target":"#pills-profile",type:"button",role:"tab","aria-controls":"pills-profile","aria-selected":"false"},"Đổi mật khẩu")])],-1)})),C={class:"tab-content",id:"pills-tabContent"},y={class:"tab-pane fade show active",id:"pills-home",role:"tabpanel","aria-labelledby":"pills-home-tab",tabindex:"0"},w={class:"form-group",disable:""},x=m((function(){return Object(a["f"])("label",{for:"phone"},"Số điện thoại",-1)})),M=["value"],R={class:"form-group"},_=m((function(){return Object(a["f"])("label",{for:"fullName"},"Họ và tên",-1)})),F={class:"form-group"},U=m((function(){return Object(a["f"])("label",null,"Ảnh đại diện: ",-1)})),I=m((function(){return Object(a["f"])("button",{class:"btn btn-signup"},"Cập nhật",-1)})),N={class:"tab-pane fade",id:"pills-profile",role:"tabpanel","aria-labelledby":"pills-profile-tab",tabindex:"0"},T={class:"form-group"},P=m((function(){return Object(a["f"])("label",{for:"currentPassword"},"Mật khẩu hiện tại",-1)})),E={class:"form-group"},q=m((function(){return Object(a["f"])("label",{for:"password"},"Mật Khẩu mới",-1)})),A={class:"form-group"},B=m((function(){return Object(a["f"])("label",{for:"confirmPassword"},"Xác nhận lại mật khẩu mới",-1)})),V=m((function(){return Object(a["f"])("button",{class:"btn btn-signup"},"Cập nhật",-1)})),D={class:"menu"},W={class:"menu_item"},L=["title"],H=["src"],z={key:1,src:b.a,alt:"avatar"},K=m((function(){return Object(a["f"])("div",{class:"icon-message",href:"#"},[Object(a["f"])("i",{class:"bx bxs-message-rounded-dots"})],-1)})),J=[K],X=m((function(){return Object(a["f"])("a",{class:"icon-message"},[Object(a["f"])("i",{class:"bx bxs-contact"})],-1)})),Q=[X],Z=m((function(){return Object(a["f"])("a",{class:"icon-message"},[Object(a["f"])("i",{class:"fa-sharp fa-solid fa-square-pen"})],-1)})),$=[Z],G=m((function(){return Object(a["f"])("div",{class:"icon-message"},[Object(a["f"])("i",{class:"fa-solid fa-right-from-bracket"})],-1)})),Y=[G];function ee(e,t,n,s,c,r){var o=this,i=Object(a["C"])("Field"),u=Object(a["C"])("ErrorMessage"),l=Object(a["C"])("Form");return Object(a["v"])(),Object(a["e"])(a["a"],null,[Object(a["f"])("div",p,[Object(a["f"])("div",g,[Object(a["f"])("div",O,[Object(a["f"])("div",j,[v,Object(a["f"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:t[0]||(t[0]=function(e){return r.clickCloseUpdateMenu()})})]),Object(a["f"])("div",k,[S,Object(a["f"])("div",C,[Object(a["f"])("div",y,[Object(a["h"])(l,{onSubmit:t[3]||(t[3]=function(e){return r.updateInfo()}),"validation-schema":c.dataUpdateInfoFormSchema,class:"form-sign",ref:"formUpdateInfo"},{default:Object(a["O"])((function(){return[Object(a["f"])("div",w,[x,Object(a["f"])("input",{type:"text",name:"",id:"phone",value:o.user.phone,class:"form-control",disabled:""},null,8,M)]),Object(a["f"])("div",R,[_,Object(a["h"])(i,{name:"fullName",type:"text",class:"form-control",modelValue:c.dataUpdateInfo.fullName,"onUpdate:modelValue":t[1]||(t[1]=function(e){return c.dataUpdateInfo.fullName=e})},null,8,["modelValue"]),Object(a["h"])(u,{name:"fullName",class:"error-feedback"})]),Object(a["f"])("div",F,[U,Object(a["f"])("button",{type:"button",onClick:t[2]||(t[2]=function(e){return r.openUploadModal()})},Object(a["E"])(""===o.dataUpdateInfo.avatar?"Upload ảnh làm ảnh đại diện.":o.nameFileAvatar),1)]),I]})),_:1},8,["validation-schema"])]),Object(a["f"])("div",N,[Object(a["h"])(l,{onSubmit:t[7]||(t[7]=function(e){return r.changePassword()}),"validation-schema":c.dataChangePasswordFormSchema,class:"form-sign",ref:"formChangePassWord"},{default:Object(a["O"])((function(){return[Object(a["f"])("div",T,[P,Object(a["h"])(i,{name:"currentPassword",type:"password",class:"form-control",modelValue:c.dataChangePassword.currentPassword,"onUpdate:modelValue":t[4]||(t[4]=function(e){return c.dataChangePassword.currentPassword=e})},null,8,["modelValue"]),Object(a["h"])(u,{name:"currentPassword",class:"error-feedback"})]),Object(a["f"])("div",E,[q,Object(a["h"])(i,{name:"password",type:"password",class:"form-control",modelValue:c.dataChangePassword.password,"onUpdate:modelValue":t[5]||(t[5]=function(e){return c.dataChangePassword.password=e})},null,8,["modelValue"]),Object(a["h"])(u,{name:"password",class:"error-feedback"})]),Object(a["f"])("div",A,[B,Object(a["h"])(i,{name:"confirmPassword",type:"password",class:"form-control",modelValue:c.dataChangePassword.confirmPassword,"onUpdate:modelValue":t[6]||(t[6]=function(e){return c.dataChangePassword.confirmPassword=e})},null,8,["modelValue"]),Object(a["h"])(u,{name:"confirmPassword",class:"error-feedback"})]),V]})),_:1},8,["validation-schema"])])])])])])]),Object(a["f"])("ul",D,[Object(a["f"])("li",W,[Object(a["f"])("div",{class:"menu_avatar",title:this.user.fullName,href:"#"},["notSignIn"!==c.statusMenu?(Object(a["v"])(),Object(a["e"])("img",{key:0,src:this.user.avatar,alt:"avatar"},null,8,H)):(Object(a["v"])(),Object(a["e"])("img",z))],8,L)]),Object(a["f"])("li",{onClick:t[8]||(t[8]=function(e){return r.clickChatMenu()}),class:Object(a["r"])([["chat"===c.statusMenu||"notSignIn"===c.statusMenu?"active":""],"menu_item"])},J,2),"notSignIn"!==c.statusMenu?(Object(a["v"])(),Object(a["e"])("li",{key:0,onClick:t[9]||(t[9]=function(e){return r.clickContactMenu()}),class:Object(a["r"])(["menu_item",["contacts"===c.statusMenu?"active":""]])},Q,2)):Object(a["d"])("",!0),"notSignIn"!==c.statusMenu?(Object(a["v"])(),Object(a["e"])("li",{key:1,onClick:t[10]||(t[10]=function(e){return r.clickUpdateMenu()}),"data-bs-toggle":"modal","data-bs-target":"#exampleModal",class:Object(a["r"])(["menu_item",["update"===c.statusMenu?"active":""]])},$,2)):Object(a["d"])("",!0),"notSignIn"!==c.statusMenu?(Object(a["v"])(),Object(a["e"])("li",{key:2,class:"menu_item menu_item-logout",onClick:t[11]||(t[11]=function(e){return r.signOut()})},Y)):Object(a["d"])("",!0)])],64)}var te=n("5530"),ne=n("1da1"),ae=(n("96cf"),n("d4ec")),se=n("bee2"),ce=n("ade3"),re=n("daa8"),oe=(n("159b"),n("77ba")),ie=n("cee4"),ue={headers:{"Content-Type":"application/json",Accept:"application/json"}},le=function(e){return ie["a"].create(Object(te["a"])({baseURL:e},ue))},de=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://redi-server-auth.onrender.com/api/auth";Object(ae["a"])(this,e),this.api=le(t)}return Object(se["a"])(e,[{key:"signIn",value:function(){var e=Object(ne["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.api.post("/signin",t);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"signUp",value:function(){var e=Object(ne["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.api.post("/signup",t);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"signOut",value:function(){var e=Object(ne["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.api.put("/signout",t);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"verifyToken",value:function(){var e=Object(ne["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.api.post("/getinfo",t);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),fe=new de,he=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://redi-server-auth.onrender.com/api/auth";Object(ae["a"])(this,e),this.api=le(t)}return Object(se["a"])(e,[{key:"updateInfo",value:function(){var e=Object(ne["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.api.put("/updateinfo",t);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"changePassword",value:function(){var e=Object(ne["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.api.put("/changepassword",t);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),be=new he,me=n("5f0a"),pe=n.n(me),ge=Object(oe["b"])("store",{state:function(){return{statusMenu:"notSignIn",statusSidebar:"notSignIn",statusContent:"notSignIn",chatRoomStranger:"",user:{_id:"",phone:"",fullName:"",avatar:"",requestContact:[],contacts:[],chatRooms:[],token:""},currentChatRoom:{fullName:"",avatar:"",messages:[],_id:"",online:!1},foundUserByPhone:{fullName:"",_id:"",avatar:"",phone:"",sentFriendRequest:!1},notifyText:"",flag:0}},actions:{setFoundUserByPhone:function(e){this.foundUserByPhone=e},showNotify:function(e){this.flag=1-this.flag,this.notifyText=e},clickContactMenu:function(){this.statusMenu="contacts",this.statusSidebar="contacts",this.statusContent="contacts",this.currentChatRoom={fullName:"",avatar:"",messages:[],_id:""}},clickChatMenu:function(){this.statusMenu="chat",this.statusSidebar="chat",this.statusContent="noChatSelected"},clickContactsSidebar:function(){this.statusMenu="contacts",this.statusSidebar="contacts",this.statusContent="contacts"},clickRequestContactSidebar:function(){this.statusMenu="contacts",this.statusSidebar="requestContact",this.statusContent="requestContact"},clickUpdateMenu:function(){this.statusMenu="update"},clickCloseUpdateMenu:function(){"chat"===this.statusSidebar?this.statusMenu="chat":this.statusMenu="contacts"},signOut:function(){this.statusMenu="notSignIn",this.statusSidebar="notSignIn",this.statusContent="notSignIn",this.user={_id:"",phone:"",fullName:"",avatar:"",requestContact:[],contacts:[],chatRooms:[],token:""},this.currentChatRoom={fullName:"",avatar:"",messages:[],_id:""}},chatWithStranger:function(){this.statusContent="chatWithStranger"},switchChatContent:function(){this.statusContent="chat"},setChatRoomStranger:function(e){this.chatRoomStranger=e},setInfoUser:function(e){this.user=e,this.user.token=this.user.token.toString(),localStorage.setItem("token",e.token)},changeOnlineStatus:function(e,t){var n=this.user.chatRooms.length;e===this.currentChatRoom._id&&(this.currentChatRoom.online=t);for(var a=0;a<n;a++)if(this.user.chatRooms[a]._id===e){this.user.chatRooms[a].online=t;break}},reloadData:function(){var e=this;return Object(ne["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,n=localStorage.getItem("token"),!n){t.next=10;break}return je.disconnect(),t.next=6,fe.verifyToken({token:n});case 6:a=t.sent,a&&(e.user=a.message),je.setupSocketFriendConnection(e.user.token,e.user.phone),je.receiveMessageFriend((function(t,n){n.roomID===e.currentChatRoom._id&&(n.seen=!0,e.currentChatRoom.messages.push(n),je.seenAllMessage(e.currentChatRoom._id),pe.a.autoSrcollTop(".content_body")),e.user.chatRooms.forEach((function(t,a){if(n.roomID===t._id)return e.user.chatRooms[a].lastMessageDate=n.createAt,void(e.user.chatRooms[a].lastMessage=n)}))}));case 10:t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](0),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))()},setMessagesChatRoom:function(e){this.currentChatRoom.messages=e,pe.a.autoSrcollTop(".content_body")},updateMessages:function(e){this.currentChatRoom._id===e&&this.currentChatRoom.messages.forEach((function(e){e.seen||(e.seen=!0)}))},updateInfo:function(e){var t=this;return Object(ne["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,be.updateInfo(e);case 3:t.user.fullName=e.fullName,t.user.avatar=e.avatar,t.showNotify("Cập nhật thông tin cơ bản thành công !"),n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](0),console.log(n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})))()},changePassword:function(e){var t=this;return Object(ne["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,be.changePassword(e);case 3:t.showNotify("Cập nhật mật khẩu thành công !"),n.next=9;break;case 6:n.prev=6,n.t0=n["catch"](0),t.showNotify(n.t0.response.data.message);case 9:case"end":return n.stop()}}),n,null,[[0,6]])})))()}}}),Oe=function(){function e(){Object(ae["a"])(this,e),Object(ce["a"])(this,"socketStranger",void 0),Object(ce["a"])(this,"socketFriend",void 0),Object(ce["a"])(this,"chatRoom","")}return Object(se["a"])(e,[{key:"setupSocketFriendConnection",value:function(e,t){this.socketFriend=Object(re["a"])("https://redi-server-friend.onrender.com",{auth:{token:e}}),console.log("Connecting socket friend..."),this.socketFriend.on("onlineStatus",(function(e){ge().changeOnlineStatus(e.roomID,e.online)})),this.socketFriend.emit("sendUser",t),this.socketFriend.on("message",(function(e){ge().reloadData(),ge().showNotify(e)})),this.socketFriend.on("updateMessages",(function(e){ge().updateMessages(e)})),this.socketFriend.on("receiveContentChatRoom",(function(e){ge().setMessagesChatRoom(e)})),this.socketFriend.on("disconnect",(function(e){"transport close"!==e&&"ping timeout"!==e&&"transport error"!==e||(console.log("[Socket Friend]Bị mất kết nối do: "+e),ge().reloadData())}))}},{key:"loadContentChatRoom",value:function(e){this.socketFriend.emit("loadContentChatRoom",e)}},{key:"findUserByPhone",value:function(e){this.socketFriend.emit("findUser",e),this.socketFriend.on("foundUser",(function(e){ge().setFoundUserByPhone(e)}))}},{key:"actionFriendRequest",value:function(e){this.socketFriend.emit("actionFriendRequest",e)}},{key:"sendFriendRequest",value:function(e){this.socketFriend.emit("sendFriendRequest",e)}},{key:"receiveMessageFriend",value:function(e){if(!this.socketFriend)return!0;this.socketFriend.on("receiveMessageFriend",(function(t){return e(null,t)}))}},{key:"sendMessageFriend",value:function(e,t){this.socketFriend&&this.socketFriend.emit("sendMessageFriend",e,t)}},{key:"seenAllMessage",value:function(e){this.socketFriend&&this.socketFriend.emit("seenAllMessage",e)}},{key:"disconnect",value:function(){this.socketFriend&&this.socketFriend.disconnect()}},{key:"setupSocketStrangerConnection",value:function(){var e=this;this.socketStranger=Object(re["a"])("https://redi-server-stranger.onrender.com"),console.log("Connecting socket stranger..."),this.socketStranger.on("disconnect",(function(t){"ping timeout"!==t&&"transport error"!==t&&"transport close"!==t||(console.log("[Socket Stranger]Bị mất kết nối do: "+t),alert("Phòng nhắn tin bị đóng do internet không ổn định !"),e.socketStranger.disconnect())}))}},{key:"receiveMessageStranger",value:function(e){if(!this.socketStranger)return!0;this.socketStranger.on("receiveMessageStranger",(function(t){return e(null,Object(te["a"])(Object(te["a"])({},t),{},{name:"Người lạ"}))}))}},{key:"statusRoomStranger",value:function(e){if(!this.socketStranger)return!0;this.socketStranger.on("statusRoomStranger",(function(t){return e(null,Object(te["a"])(Object(te["a"])({},t),{},{name:"Bot"}))}))}},{key:"nextRoomStranger",value:function(e){this.socketStranger.emit("nextRoomStranger",e)}},{key:"sendMessageStranger",value:function(e,t){this.socketStranger&&this.socketStranger.emit("sendMessageStranger",e,t)}},{key:"disconnectStranger",value:function(){this.socketStranger&&this.socketStranger.disconnect()}}]),e}(),je=new Oe,ve=n("42e9"),ke=n("7bb1"),Se={name:"Menu",components:{Form:ke["c"],Field:ke["b"],ErrorMessage:ke["a"]},data:function(){var e=ge(),t=Object(oe["c"])(e),n=t.statusMenu,a=Object(oe["c"])(e),s=a.user,c=ve["a"]().shape({fullName:ve["c"]().required("Họ và tên phải có giá trị.").min(8,"Họ và tên phải ít nhất 8 ký tự.").matches("[a-zA-Z]","Họ và tên phải ít một ký tự chữ cái.").max(50,"Họ và tên có nhiều nhất 50 ký tự.")}),r=ve["a"]().shape({currentPassword:ve["c"]().required("Mật khẩu phải có giá trị.").min(8,"Mật khẩu phải ít nhất 8 ký tự."),password:ve["c"]().required("Mật khẩu phải có giá trị.").min(8,"Mật khẩu phải ít nhất 8 ký tự."),confirmPassword:ve["c"]().oneOf([ve["b"]("password"),null],"Mật khẩu phải trùng khớp.")});return{statusMenu:n,user:s,dataChangePasswordFormSchema:r,dataUpdateInfoFormSchema:c,dataUpdateInfo:{fullName:"",avatar:""},dataChangePassword:{currentPassword:"",password:"",confirmPassword:""},nameFileAvatar:""}},watch:{user:function(){this.dataUpdateInfo.fullName=this.user.fullName}},methods:{openUploadModal:function(){var e=this;pe.a.openUploadModal("Menu",(function(t){e.nameFileAvatar=t.nameFileAvatar,e.dataUpdateInfo.avatar=t.url}))},clickContactMenu:function(){ge().clickContactMenu()},clickUpdateMenu:function(){ge().clickUpdateMenu()},clickChatMenu:function(){"notSignIn"!==this.statusMenu?ge().clickChatMenu():alert("Bạn phải đăng nhập để thực hiện chức năng này !")},clickCloseUpdateMenu:function(){ge().clickCloseUpdateMenu()},signOut:function(){var e=this;return Object(ne["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!confirm("Bạn muốn đăng xuất khỏi tài khoản này ?")){t.next=8;break}return t.next=4,fe.signOut({phone:e.user.phone});case 4:je.disconnect(),localStorage.removeItem("token"),ge().signOut(),location.reload();case 8:t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},updateInfo:function(){var e=this;return Object(ne["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""===e.dataUpdateInfo.avatar&&e.dataUpdateInfo.fullName===e.user.fullName){t.next=8;break}return""===e.dataUpdateInfo.avatar&&(e.dataUpdateInfo.avatar=e.user.avatar,e.nameFileAvatar="Ảnh đại diện hiện tại."),t.next=4,ge().updateInfo(Object(te["a"])(Object(te["a"])({},e.dataUpdateInfo),{},{_id:e.user._id}));case 4:e.user.avatar=e.dataUpdateInfo.avatar,e.dataUpdateInfo.avatar="",t.next=9;break;case 8:alert("Không có thông tin mới để cập nhật !");case 9:case"end":return t.stop()}}),t)})))()},changePassword:function(){var e=this;return Object(ne["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,ge().changePassword(Object(te["a"])(Object(te["a"])({},e.dataChangePassword),{},{_id:e.user._id}));case 2:setTimeout(e.$refs.formChangePassWord.resetForm,50),e.dataChangePassword={currentPassword:"",password:"",confirmPassword:""};case 4:case"end":return t.stop()}}),t)})))()}}};n("1b35");Se.render=ee,Se.__scopeId="data-v-5cb4f6e2";var Ce=Se,ye=(n("caad"),n("2532"),function(e){return Object(a["y"])("data-v-2e2c2b5a"),e=e(),Object(a["w"])(),e}),we=ye((function(){return Object(a["f"])("div",{class:"overlay"},null,-1)})),xe={class:"modal_form-sign"},Me=ye((function(){return Object(a["f"])("div",{class:"modal_form-sign-heading"},[Object(a["f"])("h1",null,"Đăng Ký")],-1)})),Re=ye((function(){return Object(a["f"])("div",{class:"icon-close"},[Object(a["f"])("i",{class:"bx bx-x"})],-1)})),_e={class:"form-group"},Fe=ye((function(){return Object(a["f"])("label",{for:"fullName"},"Họ và tên",-1)})),Ue={class:"form-group"},Ie=ye((function(){return Object(a["f"])("label",{for:"phone"},"Điện thoại",-1)})),Ne={class:"form-group"},Te=ye((function(){return Object(a["f"])("label",{for:"password"},"Mật Khẩu",-1)})),Pe={class:"form-group"},Ee=ye((function(){return Object(a["f"])("label",{for:"confirmPassword"},"Xác nhận lại mật khẩu",-1)})),qe={class:"form-group"},Ae=ye((function(){return Object(a["f"])("label",null,"Ảnh đại diện: ",-1)})),Be=ye((function(){return Object(a["f"])("button",{class:"btn btn-signup"},"Đăng ký",-1)})),Ve=ye((function(){return Object(a["f"])("div",{class:"login-signup"},[Object(a["f"])("span",{class:"text"},"Đã có tài khoản"),Object(a["f"])("span",{href:"#",class:"text login-link"},"Đăng nhập")],-1)})),De={class:"modal_form-login"},We=ye((function(){return Object(a["f"])("div",{class:"modal_form-sign-heading"},[Object(a["f"])("h1",null,"Đăng Nhập")],-1)})),Le=ye((function(){return Object(a["f"])("div",{class:"icon-close"},[Object(a["f"])("i",{class:"bx bx-x"})],-1)})),He={class:"form-group"},ze=ye((function(){return Object(a["f"])("label",{for:"phone"},"Điện thoại",-1)})),Ke={class:"form-group"},Je=ye((function(){return Object(a["f"])("label",{for:"password"},"Mật Khẩu",-1)})),Xe=ye((function(){return Object(a["f"])("button",{class:"btn btn-signup"},"Đăng nhập",-1)})),Qe=ye((function(){return Object(a["f"])("div",{class:"login-signup"},[Object(a["f"])("span",{class:"text"},"Bạn chưa có tài khoản? Hãy chọn"),Object(a["f"])("span",{class:"text signup-link"},"Đăng ký")],-1)})),Ze={class:"sidebar"},$e={class:"sidebar_list"},Ge={key:0,class:"sidebar_item-search"},Ye=ye((function(){return Object(a["f"])("i",{class:"bx bx-search"},null,-1)})),et=["title","onClick"],tt=["src"],nt={key:0,class:"fa-solid fa-circle"},at={class:"sidebar_content"},st={class:"sidebar_name"},ct={key:0,class:"sidebar_message"},rt={key:1,class:"sidebar_message"},ot={class:"content_body-signup"},it=ye((function(){return Object(a["f"])("button",{href:"#",class:"btn btn-sign",id:"open-form-dangnhap1"},"Đăng Ký",-1)})),ut=ye((function(){return Object(a["f"])("button",{href:"#",class:"btn btn-log"},"Đăng Nhập",-1)})),lt=ye((function(){return Object(a["f"])("div",{class:"note"},' *Bằng cách bấm vào phần "Người lạ", bạn có thể trò chuyện ngay với người lạ mà không cần Đăng nhập. ',-1)})),dt=[it,ut,lt],ft=ye((function(){return Object(a["f"])("i",{class:"bx bxs-group"},null,-1)})),ht=ye((function(){return Object(a["f"])("div",{class:"sidebar_content"},[Object(a["f"])("h3",{class:"sidebar_name"},"Danh sách bạn bè")],-1)})),bt=[ft,ht],mt=ye((function(){return Object(a["f"])("i",{class:"bx bxs-user-plus"},null,-1)})),pt=ye((function(){return Object(a["f"])("div",{class:"sidebar_content"},[Object(a["f"])("h3",{class:"sidebar_name"},"Danh sách kết bạn")],-1)})),gt=[mt,pt],Ot=["title"],jt=["src"],vt={class:"sidebar_content"},kt={class:"sidebar_name"},St={key:1,id:"btn-requestContact",disabled:""};function Ct(e,t){var n=this,s=Object(a["C"])("Field"),c=Object(a["C"])("ErrorMessage"),r=Object(a["C"])("Form");return Object(a["v"])(),Object(a["e"])(a["a"],null,[we,Object(a["f"])("div",xe,[Me,Re,Object(a["h"])(r,{onSubmit:t[5]||(t[5]=function(t){return e.signUp()}),"validation-schema":e.dataSignUpFormSchema,class:"form-sign",ref:"formSignUp"},{default:Object(a["O"])((function(){return[Object(a["f"])("div",_e,[Fe,Object(a["h"])(s,{name:"fullName",type:"text",class:"form-control",modelValue:e.dataSignUp.fullName,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.dataSignUp.fullName=t})},null,8,["modelValue"]),Object(a["h"])(c,{name:"fullName",class:"error-feedback"})]),Object(a["f"])("div",Ue,[Ie,Object(a["h"])(s,{name:"phone",type:"tel",class:"form-control",modelValue:e.dataSignUp.phone,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.dataSignUp.phone=t})},null,8,["modelValue"]),Object(a["h"])(c,{name:"phone",class:"error-feedback"})]),Object(a["f"])("div",Ne,[Te,Object(a["h"])(s,{name:"password",type:"password",class:"form-control",modelValue:e.dataSignUp.password,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.dataSignUp.password=t})},null,8,["modelValue"]),Object(a["h"])(c,{name:"password",class:"error-feedback"})]),Object(a["f"])("div",Pe,[Ee,Object(a["h"])(s,{name:"confirmPassword",type:"password",class:"form-control",modelValue:e.dataSignUp.confirmPassword,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.dataSignUp.confirmPassword=t})},null,8,["modelValue"]),Object(a["h"])(c,{name:"confirmPassword",class:"error-feedback"})]),Object(a["f"])("div",qe,[Ae,Object(a["f"])("button",{type:"button",onClick:t[4]||(t[4]=function(t){return e.openUploadModal()})},Object(a["E"])(""===n.dataSignUp.avatar?"Upload ảnh làm ảnh đại diện.":n.nameFileAvatar),1)]),Be,Ve]})),_:1},8,["validation-schema"])]),Object(a["f"])("div",De,[We,Le,Object(a["h"])(r,{onSubmit:t[8]||(t[8]=function(t){return e.signIn()}),"validation-schema":e.dataSignInFormSchema,class:"form-sign",ref:"formSignIn"},{default:Object(a["O"])((function(){return[Object(a["f"])("div",He,[ze,Object(a["h"])(s,{name:"phone",type:"tel",class:"form-control",modelValue:e.dataSignIn.phone,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.dataSignIn.phone=t})},null,8,["modelValue"]),Object(a["h"])(c,{name:"phone",class:"error-feedback"})]),Object(a["f"])("div",Ke,[Je,Object(a["h"])(s,{name:"password",type:"password",class:"form-control",modelValue:e.dataSignIn.password,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.dataSignIn.password=t})},null,8,["modelValue"]),Object(a["h"])(c,{name:"password",class:"error-feedback"})]),Xe,Qe]})),_:1},8,["validation-schema"])]),Object(a["f"])("div",Ze,[Object(a["f"])("div",$e,["notSignIn"!==e.statusSidebar?(Object(a["v"])(),Object(a["e"])("div",Ge,[Object(a["f"])("form",{onSubmit:t[10]||(t[10]=Object(a["Q"])((function(e){return n.findUser()}),["prevent"]))},[Object(a["P"])(Object(a["f"])("input",{type:"text",placeholder:"Tìm kiếm","onUpdate:modelValue":t[9]||(t[9]=function(e){return n.searchText=e})},null,512),[[a["J"],this.searchText]])],32),Ye])):Object(a["d"])("",!0),"notSignIn"===e.statusSidebar||"chat"===e.statusSidebar?(Object(a["v"])(!0),Object(a["e"])(a["a"],{key:1},Object(a["B"])(this.chatRooms,(function(t,s){return Object(a["v"])(),Object(a["e"])("div",{key:s,class:Object(a["r"])(["sidebar_item",[t._id===n.currentChatRoom._id?"active":"",t.lastMessage?t.lastMessage.seen||t.lastMessage.sender===n.user._id?"":"new":""]]),title:t.fullNameFriend,onClick:function(n){return e.openChatContent(t)}},[Object(a["f"])("img",{src:t.avatar,alt:""},null,8,tt),t.online?(Object(a["v"])(),Object(a["e"])("i",nt)):Object(a["d"])("",!0),Object(a["f"])("div",at,[Object(a["f"])("h3",st,Object(a["E"])(t.fullNameFriend),1),t.lastMessage?(Object(a["v"])(),Object(a["e"])(a["a"],{key:0},["image"===t.lastMessage.type?(Object(a["v"])(),Object(a["e"])("span",ct,"Hình ảnh")):(Object(a["v"])(),Object(a["e"])("span",rt,Object(a["E"])(t.lastMessage.content),1))],64)):Object(a["d"])("",!0)])],10,et)})),128)):Object(a["d"])("",!0),Object(a["P"])(Object(a["f"])("div",ot,dt,512),[[a["K"],"notSignIn"===e.statusSidebar]]),e.statusSidebar.includes("ontact")&&!this.checkSearchByPhone?(Object(a["v"])(),Object(a["e"])(a["a"],{key:2},[Object(a["f"])("div",{onClick:t[11]||(t[11]=function(t){return e.clickContactsSidebar()})},[Object(a["f"])("div",{class:Object(a["r"])(["sidebar_item",["contacts"===e.statusSidebar?"active":""]])},bt,2)]),Object(a["f"])("div",{onClick:t[12]||(t[12]=function(t){return e.clickRequestContactSidebar()&&!n.checkSearchByPhone})},[Object(a["f"])("div",{class:Object(a["r"])(["sidebar_item",["requestContact"===e.statusSidebar?"active":""]])},gt,2)])],64)):Object(a["d"])("",!0),this.foundUserByPhone.fullName&&this.chatRooms.length<1?(Object(a["v"])(),Object(a["e"])("div",{key:3,class:"sidebar_item",title:this.foundUserByPhone.fullName},[Object(a["f"])("img",{src:this.foundUserByPhone.avatar,alt:""},null,8,jt),Object(a["f"])("div",vt,[Object(a["f"])("h3",kt,Object(a["E"])(this.foundUserByPhone.fullName),1)]),this.foundUserByPhone.sentFriendRequest?(Object(a["v"])(),Object(a["e"])("button",St," Đã gửi lời mời kết bạn ")):(Object(a["v"])(),Object(a["e"])("button",{key:0,id:"btn-requestContact",onClick:t[13]||(t[13]=function(t){return e.sendFriendRequest()})}," Kết bạn "))],8,Ot)):Object(a["d"])("",!0)])])],64)}n("ac1f"),n("466d"),n("d81d"),n("a15b"),n("4e82"),n("99af"),n("4de4");var yt={name:"Sidebar",components:{Form:ke["c"],Field:ke["b"],ErrorMessage:ke["a"]},mounted:function(){this.processFormSignInSignUp(),this.verifyToken()},data:function(){var e=ge(),t=Object(oe["c"])(e),n=t.statusSidebar,a=Object(oe["c"])(e),s=a.statusContent,c=Object(oe["c"])(e),r=c.statusMenu,o=Object(oe["c"])(e),i=o.user,u=Object(oe["c"])(e),l=u.currentChatRoom,d=Object(oe["c"])(e),f=d.foundUserByPhone,h=ve["a"]().shape({fullName:ve["c"]().required("Họ và tên phải có giá trị.").min(8,"Họ và tên phải ít nhất 8 ký tự.").matches("[a-zA-Z]","Họ và tên phải ít một ký tự chữ cái.").max(50,"Họ và tên có nhiều nhất 50 ký tự."),password:ve["c"]().required("Mật khẩu phải có giá trị.").min(8,"Mật khẩu phải ít nhất 8 ký tự."),phone:ve["c"]().matches(/((09|03|07|08|05)+([0-9]{8})\b)/g,"Số điện thoại không hợp lệ."),confirmPassword:ve["c"]().oneOf([ve["b"]("password"),null],"Mật khẩu phải trùng khớp.")}),b=ve["a"]().shape({password:ve["c"]().required("Mật khẩu phải có giá trị.").min(8,"Mật khẩu phải ít nhất 8 ký tự."),phone:ve["c"]().matches(/((09|03|07|08|05)+([0-9]{8})\b)/g,"Số điện thoại không hợp lệ.")});return{statusSidebar:n,statusContent:s,statusMenu:r,dataSignUp:{phone:"",password:"",fullName:"",confirmPassword:"",avatar:""},dataSignIn:{phone:"",password:""},dataSignUpFormSchema:h,dataSignInFormSchema:b,nameFileAvatar:"",user:i,searchText:"",currentChatRoom:l,foundUserByPhone:f,checkSearchByPhone:!1}},watch:{searchText:function(){var e=this.searchText.match(/((09|03|07|08|05)+([0-9]{8})\b)/);e||(this.foundUserByPhone={fullName:"",_id:"",avatar:"",phone:"",sentFriendRequest:!1},this.checkSearchByPhone=!1)}},computed:{chatRoomsString:function(){var e=this,t=this.user.chatRooms.map((function(t){if("000"===t._id)return"";var n,a=t.owner[0]===e.user._id?t.owner[1]:t.owner[0];return e.user.contacts.forEach((function(e){a===e._id&&(n=e.phone)})),[n,pe.a.removeAccents(t.fullNameFriend)].join("")}));return t},chatRooms:function(){var e=this;if(""===this.searchText){var t={_id:"000",owner:[],lastMessageDate:"0:0 0-0-0",fullNameFriend:"Người lạ",avatar:"http://res.cloudinary.com/dwnunieno/image/upload/v1679058005/sdrdzt5t2bhs5lvgsflj.png",online:!1},n=this.user.chatRooms;return n.sort(pe.a.compareFn),[t].concat(n)}var a=pe.a.removeAccents(this.searchText),s=this.user.chatRooms.filter((function(t,n){return e.chatRoomsString[n].includes(a)})).sort(pe.a.compareFn);return s}},methods:{processFormSignInSignUp:function(){var e=document.querySelector(".btn-sign"),t=document.querySelector(".modal_form-sign"),n=document.querySelectorAll(".icon-close"),a=document.querySelector(".btn-log"),s=document.querySelector(".modal_form-login"),c=document.querySelector(".overlay"),r=document.querySelector(".signup-link"),o=document.querySelector(".login-link");e.addEventListener("click",(function(){t.classList.add("open"),c.classList.add("open")})),a.addEventListener("click",(function(){s.classList.add("open"),c.classList.add("open")})),n.forEach((function(e){e.addEventListener("click",(function(){t.classList.remove("open"),s.classList.remove("open"),c.classList.remove("open")}))})),r.addEventListener("click",(function(){t.classList.add("open"),s.classList.remove("open")})),o.addEventListener("click",(function(){s.classList.add("open"),t.classList.remove("open")}))},verifyToken:function(){var e=this;return Object(ne["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,n=localStorage.getItem("token"),!n){t.next=7;break}return t.next=5,fe.verifyToken({token:n});case 5:a=t.sent,a&&(ge().setInfoUser(a.message),je.setupSocketFriendConnection(a.message.token,a.message.phone),je.receiveMessageFriend((function(t,n){n.roomID===e.currentChatRoom._id&&(n.seen=!0,e.currentChatRoom.messages.push(n),je.seenAllMessage(e.currentChatRoom._id),pe.a.autoSrcollTop(".content_body")),e.user.chatRooms.forEach((function(t,a){if(n.roomID===t._id)return e.user.chatRooms[a].lastMessage=n,void(e.user.chatRooms[a].lastMessageDate=n.createAt)}))})),ge().clickChatMenu());case 7:t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},clickContactsSidebar:function(){ge().clickContactsSidebar()},clickRequestContactSidebar:function(){ge().clickRequestContactSidebar()},openChatContent:function(e){e._id!==this.currentChatRoom._id&&(this.currentChatRoom=Object(te["a"])(Object(te["a"])({},e),{},{messages:[]}),"000"===e._id?ge().chatWithStranger():(je.loadContentChatRoom(e._id.toString()),this.user.chatRooms.forEach((function(t){e._id===t._id&&t.lastMessage&&(t.lastMessage.seen=!0)})),je.seenAllMessage(e._id),ge().switchChatContent()))},openUploadModal:function(){var e=this;pe.a.openUploadModal("Sidebar",(function(t){e.dataSignUp.avatar=t.url,e.nameFileAvatar=t.nameFileAvatar}))},signUp:function(){var e=this;return Object(ne["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,""===e.dataSignUp.avatar&&(e.dataSignUp.avatar="https://res.cloudinary.com/dwnunieno/image/upload/v1678895187/ojzoerhuvkv8ealatzqz.png"),t.next=4,fe.signUp(e.dataSignUp);case 4:document.querySelector(".modal_form-sign").classList.remove("open"),e.dataSignIn={phone:e.dataSignUp.phone,password:e.dataSignUp.password},ge().showNotify("Chào mừng bạn đến với Redi !"),e.signIn(),e.dataSignUp={phone:"",password:"",fullName:"",address:"",avatar:""},setTimeout(e.$refs.formSignUp.resetForm,500),t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](0),alert(t.t0.response.data.message.toString()),"https://res.cloudinary.com/dwnunieno/image/upload/v1678895187/ojzoerhuvkv8ealatzqz.png"===e.dataSignUp.avatar&&(e.dataSignUp.avatar="");case 16:case"end":return t.stop()}}),t,null,[[0,12]])})))()},signIn:function(){var e=this;return Object(ne["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fe.signIn(e.dataSignIn);case 3:n=t.sent,ge().setInfoUser(n.message),je.setupSocketFriendConnection(n.message.token,n.message.phone),document.querySelector(".modal_form-login").classList.remove("open"),document.querySelector(".overlay").classList.remove("open"),e.currentChatRoom={fullName:"",avatar:"",messages:[],_id:"",online:!1},ge().clickChatMenu(),e.dataSignIn={phone:"",password:""},je.receiveMessageFriend((function(t,n){n.roomID===e.currentChatRoom._id&&(n.seen=!0,e.currentChatRoom.messages.push(n),je.seenAllMessage(e.currentChatRoom._id),pe.a.autoSrcollTop(".content_body")),e.user.chatRooms.forEach((function(t,a){if(n.roomID===t._id)return e.user.chatRooms[a].lastMessage=n,void(e.user.chatRooms[a].lastMessageDate=n.createAt)}))})),setTimeout(e.$refs.formSignIn.resetForm,1e3),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](0),alert(t.t0.response.data.message.toString());case 17:case"end":return t.stop()}}),t,null,[[0,14]])})))()},findUser:function(){var e=this;if(!(this.chatRooms.length>0)){if(this.searchText===this.user.phone)return alert(this.user.phone+" là số điện thoại của bạn mà !"),void(this.searchText="");var t=this.searchText.match(/((09|03|07|08|05)+([0-9]{8})\b)/);t?(this.user.requestContact.forEach((function(n){if(n.phone===e.searchText)return alert('Số điện thoại: "'.concat(e.searchText,'" (').concat(n.fullName,") đã gửi lời mời kết bạn cho bạn !")),e.searchText="",void(t=!1)})),t&&(je.findUserByPhone(this.searchText),this.checkSearchByPhone=!0,this.currentChatRoom={fullName:"",avatar:"",messages:[],_id:""},"chat"===this.statusMenu&&(this.statusContent="noChatSelected"))):alert('Số điện thoại: "'.concat(this.searchText,'" chưa hợp lệ !'))}},sendFriendRequest:function(){je.sendFriendRequest(this.foundUserByPhone.phone),this.searchText="",this.foundUserByPhone={fullName:"",_id:"",avatar:"",phone:"",sentFriendRequest:!1}}}};n("2749");yt.render=Ct,yt.__scopeId="data-v-2e2c2b5a";var wt=yt,xt=(n("b0c0"),n("527f")),Mt=n.n(xt),Rt=n("5058"),_t=n.n(Rt),Ft=n("e7ba"),Ut=n.n(Ft),It=function(e){return Object(a["y"])("data-v-3300e75f"),e=e(),Object(a["w"])(),e},Nt={key:0,class:"content"},Tt={class:"content_header"},Pt=["src"],Et={key:0,class:"fa-solid fa-circle"},qt={class:"content_header-title"},At={class:"content_body"},Bt={class:"chat-box"},Vt={key:0,class:"mess-incoming"},Dt={class:"mess-avatar"},Wt=["src"],Lt={key:0,class:"details"},Ht={class:"mess-text"},zt={class:"mess-name"},Kt={class:"mess-time"},Jt=It((function(){return Object(a["f"])("br",null,null,-1)})),Xt={key:1,class:"mess-img",style:{"margin-bottom":"10px"}},Qt=["src"],Zt={key:1,class:"mess-outgoing"},$t=["title"],Gt={class:"mess-time"},Yt=It((function(){return Object(a["f"])("br",null,null,-1)})),en=["title"],tn=["src"],nn={key:2,class:"mess-seen"},an=["src"],sn={class:"chat-footer"},cn={class:"chat-footer"},rn=It((function(){return Object(a["f"])("i",{class:"fa-solid fa-image"},null,-1)})),on=[rn],un=It((function(){return Object(a["f"])("button",{type:"submit"},[Object(a["f"])("i",{class:"fa-solid fa-paper-plane"})],-1)})),ln={key:1,class:"content"},dn={class:"content_header"},fn=It((function(){return Object(a["f"])("img",{class:"content_header-img",src:Mt.a,alt:""},null,-1)})),hn=It((function(){return Object(a["f"])("div",{class:"content_header-title"},[Object(a["f"])("h1",null,"Người lạ")],-1)})),bn={class:"content_header-right"},mn=It((function(){return Object(a["f"])("i",{class:"fa-solid fa-comment-medical"},null,-1)})),pn=It((function(){return Object(a["f"])("i",{class:"fa-solid fa-comment-slash"},null,-1)})),gn={class:"content_body"},On={class:"chat-box"},jn={key:0,class:"mess-incoming"},vn=It((function(){return Object(a["f"])("div",{class:"mess-avatar"},[Object(a["f"])("img",{src:Mt.a,alt:""})],-1)})),kn={key:0,class:"details"},Sn={class:"mess-text"},Cn={class:"mess-name"},yn={class:"mess-time"},wn=It((function(){return Object(a["f"])("br",null,null,-1)})),xn={key:1,class:"mess-img"},Mn=["src"],Rn={key:1,class:"mess-incoming"},_n=It((function(){return Object(a["f"])("div",{class:"mess-avatar"},[Object(a["f"])("img",{src:_t.a,alt:""})],-1)})),Fn={class:"details"},Un={class:"mess-text"},In={class:"mess-name"},Nn={class:"mess-time"},Tn=It((function(){return Object(a["f"])("br",null,null,-1)})),Pn={key:2,class:"mess-outgoing"},En={key:0,class:"mess-text"},qn={class:"mess-time"},An=It((function(){return Object(a["f"])("br",null,null,-1)})),Bn={key:1,class:"mess-img"},Vn=["src"],Dn={class:"chat-footer"},Wn=It((function(){return Object(a["f"])("i",{class:"fa-solid fa-image"},null,-1)})),Ln=[Wn],Hn=It((function(){return Object(a["f"])("button",{id:"btn-sendMess",type:"submit"},[Object(a["f"])("i",{class:"fa-solid fa-paper-plane"})],-1)})),zn={key:2,class:"contact_main"},Kn=It((function(){return Object(a["f"])("div",{class:"content_header"},[Object(a["f"])("i",{class:"bx bxs-user-plus"}),Object(a["f"])("div",{class:"content_header-title"},[Object(a["f"])("h1",null,"Danh sách kết bạn")])],-1)})),Jn={class:"contact_list"},Xn=["title"],Qn=["src"],Zn={class:"contact_content"},$n={class:"contact_name"},Gn={class:"contact_action"},Yn=["onClick"],ea=["onClick"],ta={key:3,class:"contact_main"},na=It((function(){return Object(a["f"])("div",{class:"content_header"},[Object(a["f"])("i",{class:"bx bxs-group"}),Object(a["f"])("div",{class:"content_header-title"},[Object(a["f"])("h1",null,"Danh sách bạn bè")])],-1)})),aa={class:"contact_list"},sa=["title"],ca=["src"],ra={class:"contact_content"},oa={class:"contact_name"},ia={key:4,class:"contact_main introduce"},ua=It((function(){return Object(a["f"])("img",{src:Ut.a,alt:""},null,-1)})),la=It((function(){return Object(a["f"])("h1",null,"REDI",-1)})),da=It((function(){return Object(a["f"])("h2",null,"XOÁ NHOÀ KHOẢNG CÁCH",-1)})),fa=[ua,la,da],ha={key:5,class:"contact_main no-chat-selected"},ba=It((function(){return Object(a["f"])("img",{src:Ut.a,alt:""},null,-1)})),ma=It((function(){return Object(a["f"])("p",null,"chào mừng bạn đến với REDI, ",-1)})),pa=It((function(){return Object(a["f"])("p",null,"bắt đầu trò chuyện với những người mà bạn yêu thương nào !",-1)}));function ga(e,t){var n=this;return Object(a["v"])(),Object(a["e"])(a["a"],null,["chat"===e.statusContent?(Object(a["v"])(),Object(a["e"])("div",Nt,[Object(a["f"])("div",Tt,[Object(a["f"])("img",{class:"content_header-img",src:this.currentChatRoom.avatar,alt:""},null,8,Pt),Object(a["f"])("span",null,[this.currentChatRoom.online?(Object(a["v"])(),Object(a["e"])("i",Et)):Object(a["d"])("",!0)]),Object(a["f"])("div",qt,[Object(a["f"])("h1",null,Object(a["E"])(this.currentChatRoom.fullNameFriend),1)])]),Object(a["f"])("div",At,[Object(a["f"])("div",Bt,[(Object(a["v"])(!0),Object(a["e"])(a["a"],null,Object(a["B"])(this.messages,(function(t,s){return Object(a["v"])(),Object(a["e"])("div",{key:s},[t.sender!==n.user._id?(Object(a["v"])(),Object(a["e"])("div",Vt,[Object(a["f"])("div",Dt,[Object(a["f"])("img",{src:n.currentChatRoom.avatar,alt:""},null,8,Wt)]),"text"===t.type?(Object(a["v"])(),Object(a["e"])("div",Lt,[Object(a["f"])("div",Ht,[Object(a["f"])("div",zt,Object(a["E"])(n.currentChatRoom.fullNameFriend),1),Object(a["g"])(" "+Object(a["E"])(t.content)+" ",1),Object(a["f"])("div",Kt,[Jt,Object(a["g"])(Object(a["E"])(e.formatTime(t.createAt)),1)])])])):"image"===t.type?(Object(a["v"])(),Object(a["e"])("div",Xt,[Object(a["f"])("img",{src:t.content,alt:""},null,8,Qt)])):Object(a["d"])("",!0)])):(Object(a["v"])(),Object(a["e"])("div",Zt,["text"===t.type?(Object(a["v"])(),Object(a["e"])("div",{key:0,class:"mess-text",title:[t.seen?"Đã xem":"Đã gửi"]},[Object(a["g"])(Object(a["E"])(t.content)+" ",1),Object(a["f"])("div",Gt,[Yt,Object(a["g"])(Object(a["E"])(e.formatTime(t.createAt)),1)])],8,$t)):"image"===t.type?(Object(a["v"])(),Object(a["e"])("div",{key:1,class:"mess-img",style:{"margin-bottom":"10px"},title:[t.seen?"Đã xem":"Đã gửi"]},[Object(a["f"])("img",{src:t.content,alt:""},null,8,tn)],8,en)):Object(a["d"])("",!0)])),s===n.lastSeenMessage?(Object(a["v"])(),Object(a["e"])("div",nn,[Object(a["f"])("img",{src:n.currentChatRoom.avatar,alt:""},null,8,an)])):Object(a["d"])("",!0)])})),128))])]),Object(a["f"])("div",sn,[Object(a["f"])("div",cn,[Object(a["f"])("button",{onClick:t[0]||(t[0]=function(t){return e.openUploadModal()})},on),Object(a["f"])("form",{class:"",onSubmit:t[2]||(t[2]=Object(a["Q"])((function(t){return e.sendMessageFriend("text")}),["prevent"]))},[Object(a["P"])(Object(a["f"])("input",{type:"text",placeholder:"Nhập vào nội dung bạn muốn nhắn....","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.inputMessageText=t})},null,512),[[a["J"],e.inputMessageText]]),un],32)])])])):Object(a["d"])("",!0),"chatWithStranger"===e.statusContent?(Object(a["v"])(),Object(a["e"])("div",ln,[Object(a["f"])("div",dn,[fn,hn,Object(a["f"])("div",bn,[Object(a["f"])("button",{id:"btn-newChat",style:{"margin-right":"15px"},onClick:t[3]||(t[3]=function(t){return e.connectSocketStranger()})},[mn,Object(a["g"])(" Phòng nhắn tin mới ")]),Object(a["f"])("button",{id:"btn-stopChat",onClick:t[4]||(t[4]=function(t){return e.stopChatStranger()})},[pn,Object(a["g"])(" Kết thúc ")])])]),Object(a["f"])("div",gn,[Object(a["f"])("div",On,[(Object(a["v"])(!0),Object(a["e"])(a["a"],null,Object(a["B"])(e.messagesChatWithStranger,(function(t,n){return Object(a["v"])(),Object(a["e"])("div",{key:n},["Người lạ"===t.name?(Object(a["v"])(),Object(a["e"])("div",jn,[vn,"text"===t.type?(Object(a["v"])(),Object(a["e"])("div",kn,[Object(a["f"])("div",Sn,[Object(a["f"])("div",Cn,Object(a["E"])(t.name),1),Object(a["g"])(" "+Object(a["E"])(t.content)+" ",1),Object(a["f"])("div",yn,[wn,Object(a["g"])(Object(a["E"])(e.formatTime(t.createAt)),1)])])])):"image"===t.type?(Object(a["v"])(),Object(a["e"])("div",xn,[Object(a["f"])("img",{src:t.content,alt:""},null,8,Mn)])):Object(a["d"])("",!0)])):"Bot"===t.name?(Object(a["v"])(),Object(a["e"])("div",Rn,[_n,Object(a["f"])("div",Fn,[Object(a["f"])("div",Un,[Object(a["f"])("div",In,Object(a["E"])(t.name),1),Object(a["g"])(" "+Object(a["E"])(t.content)+" ",1),Object(a["f"])("div",Nn,[Tn,Object(a["g"])(Object(a["E"])(e.formatTime(t.createAt)),1)])])])])):(Object(a["v"])(),Object(a["e"])("div",Pn,["text"===t.type?(Object(a["v"])(),Object(a["e"])("div",En,[Object(a["g"])(Object(a["E"])(t.content)+" ",1),Object(a["f"])("div",qn,[An,Object(a["g"])(Object(a["E"])(e.formatTime(t.createAt)),1)])])):"image"===t.type?(Object(a["v"])(),Object(a["e"])("div",Bn,[Object(a["f"])("img",{src:t.content,alt:""},null,8,Vn)])):Object(a["d"])("",!0)]))])})),128))])]),Object(a["f"])("div",Dn,[Object(a["f"])("button",{onClick:t[5]||(t[5]=function(t){return e.openUploadModal()}),id:"btn-sendImg"},Ln),Object(a["f"])("form",{class:"",onSubmit:t[7]||(t[7]=Object(a["Q"])((function(t){return e.sendMessageStranger("text")}),["prevent"]))},[Object(a["P"])(Object(a["f"])("input",{id:"input-sendMess",type:"text",placeholder:"Nhập vào nội dung bạn muốn nhắn....","onUpdate:modelValue":t[6]||(t[6]=function(t){return e.inputMessageTextChatWithStranger=t})},null,512),[[a["J"],e.inputMessageTextChatWithStranger]]),Hn],32)])])):Object(a["d"])("",!0),"requestContact"===e.statusContent?(Object(a["v"])(),Object(a["e"])("div",zn,[Kn,Object(a["f"])("div",Jn,[(Object(a["v"])(!0),Object(a["e"])(a["a"],null,Object(a["B"])(e.user.requestContact,(function(e,t){return Object(a["v"])(),Object(a["e"])("div",{key:t,class:"contact_item",title:e.fullName},[Object(a["f"])("img",{src:e.avatar,alt:""},null,8,Qn),Object(a["f"])("div",Zn,[Object(a["f"])("h3",$n,Object(a["E"])(e.fullName),1)]),Object(a["f"])("div",Gn,[Object(a["f"])("button",{class:"btn btn_accept",onClick:function(t){return n.actionFriendRequest({phone:e.phone,accept:!0})}},"Chấp nhận",8,Yn),Object(a["f"])("button",{class:"btn btn_deny",onClick:function(t){return n.actionFriendRequest({phone:e.phone,accept:!1})}},"Từ chối",8,ea)])],8,Xn)})),128))])])):Object(a["d"])("",!0),"contacts"===e.statusContent?(Object(a["v"])(),Object(a["e"])("div",ta,[na,Object(a["f"])("div",aa,[(Object(a["v"])(!0),Object(a["e"])(a["a"],null,Object(a["B"])(e.user.contacts,(function(e,t){return Object(a["v"])(),Object(a["e"])("div",{key:t,class:"contact_item",title:e.fullName},[Object(a["f"])("img",{src:e.avatar,alt:""},null,8,ca),Object(a["f"])("div",ra,[Object(a["f"])("h3",oa,Object(a["E"])(e.fullName),1)])],8,sa)})),128))])])):Object(a["d"])("",!0),"notSignIn"===e.statusContent?(Object(a["v"])(),Object(a["e"])("div",ia,fa)):Object(a["d"])("",!0),"noChatSelected"===e.statusContent?(Object(a["v"])(),Object(a["e"])("div",ha,[ba,Object(a["f"])("p",null,"Xin chào "+Object(a["E"])(this.user.fullName.substr(this.user.fullName.toString().lastIndexOf(" "))),1),ma,pa])):Object(a["d"])("",!0)],64)}var Oa={name:"Content",data:function(){var e=ge(),t=Object(oe["c"])(e),n=t.statusContent,a=Object(oe["c"])(e),s=a.chatRoomStranger,c=Object(oe["c"])(e),r=c.user,o=Object(oe["c"])(e),i=o.currentChatRoom,u=["#btn-sendImg","#btn-sendMess","#input-sendMess"],l=["#btn-newChat"],d=["#btn-stopChat"];return{statusContent:n,messagesChatWithStranger:[],inputMessageTextChatWithStranger:"",url:"",chatRoomStranger:s,user:r,inputMessageText:"",currentChatRoom:i,eFormInput:u,eNewChat:l,eStopChat:d}},computed:{messages:function(){return this.currentChatRoom.messages.length>0?this.currentChatRoom.messages:[]},lastSeenMessage:function(){if(this.currentChatRoom.messages.length>0)for(var e=this.currentChatRoom.messages.length-1;e>=0;e--)if(this.currentChatRoom.messages[e].sender===this.user._id&&this.currentChatRoom.messages[e].seen)return e;return-1}},watch:{statusContent:function(e,t){var n=this;"chatWithStranger"===e&&setTimeout((function(){n.chatRoomStranger?pe.a.disableElements(n.eFormInput.concat(n.eStopChat).concat(n.eNewChat),!1):(pe.a.disableElements(n.eNewChat,!1),pe.a.disableElements(n.eFormInput.concat(n.eStopChat),!0)),t.toString()}),80)},messagesChatWithStranger:{deep:!0,handler:function(){pe.a.autoSrcollTop(".content_body")}}},methods:{sendMessageFriend:function(e){var t,n=this;e&&("text"===e&&""!==this.inputMessageText&&(t={content:this.inputMessageText,type:e,roomID:this.currentChatRoom._id},this.inputMessageText=""),"image"===e&&(t={content:this.url,type:e,roomID:this.currentChatRoom._id},this.url=""),t&&(console.log("sending message friend...."),je.sendMessageFriend(t,(function(e){n.currentChatRoom.messages.push(Object(te["a"])(Object(te["a"])({},t),{},{createAt:e.createAt,sender:n.user._id,seen:!1})),pe.a.autoSrcollTop(".content_body")}))))},openUploadModal:function(){var e=this;window.cloudinary.createUploadWidget({cloud_name:"dwnunieno",upload_preset:"ma9pfovj",maxImageFileSize:1e7,autoMinimize:!0,sources:["local"],clientAllowedFormats:["image"],maxFiles:5},(function(t,n){!t&&n&&"success"===n.event&&(console.log("Done uploading..: ",n.info),e.url=n.info.url,console.log(e.url),"000"===e.currentChatRoom._id?e.sendMessageStranger("image"):e.sendMessageFriend("image"))})).open()},connectSocketStranger:function(){var e=this;setTimeout((function(){var t=e.chatRoomStranger;""!==t?(e.messagesChatWithStranger=[{content:"Đang đợi người lạ ...",name:"Bot"}],pe.a.disableElements(e.eFormInput.concat(e.eNewChat),!0),pe.a.disableElements(e.eStopChat,!1),je.nextRoomStranger(t)):(je.setupSocketStrangerConnection(),je.statusRoomStranger((function(t,n){if("Đang đợi người lạ ..."===n.content&&(pe.a.disableElements(e.eFormInput.concat(e.eNewChat),!0),pe.a.disableElements(e.eStopChat,!1)),n.content.includes("NextRoom")?(n.content="Người lạ đã rời đi. Đang đợi người lạ ...",pe.a.disableElements(e.eFormInput.concat(e.eNewChat),!0),pe.a.disableElements(e.eStopChat,!1),ge().setChatRoomStranger("")):e.messagesChatWithStranger.length>0&&(e.messagesChatWithStranger=[]),n.content.includes("Người lạ đã vào phòng")){var a=n.content.substr(n.content.indexOf("|")+1,n.content.length-1);ge().setChatRoomStranger(a),n.content=n.content.substr(0,n.content.indexOf("|")),pe.a.disableElements(e.eFormInput.concat(e.eStopChat).concat(e.eNewChat),!1)}"Người lạ đã rời đi. Đang đợi người lạ kế tiếp ..."===n.content&&(pe.a.disableElements(e.eFormInput.concat(e.eNewChat),!0),pe.a.disableElements(e.eStopChat,!1)),e.messagesChatWithStranger.push({name:n.name,content:n.content,type:"text",createAt:n.createAt})})),je.receiveMessageStranger((function(t,n){e.messagesChatWithStranger.push(n)})))}),80)},sendMessageStranger:function(e){var t,n=this;e&&("text"===e&&""!==this.inputMessageTextChatWithStranger&&(t={content:this.inputMessageTextChatWithStranger,type:e},this.inputMessageTextChatWithStranger=""),"image"===e&&(t={content:this.url,type:e},this.url=""),t&&(console.log("sending message stranger...."),je.sendMessageStranger(t,(function(e){n.messagesChatWithStranger.push(Object(te["a"])(Object(te["a"])({},t),{},{createAt:e.createAt,name:"Me"}))}))))},stopChatStranger:function(){var e=this;setTimeout((function(){je.disconnectStranger(),e.messagesChatWithStranger.push({type:"text",createAt:pe.a.getTime(),content:"Bạn đã rời khỏi phòng !",name:"Bot"}),ge().setChatRoomStranger(""),pe.a.disableElements(e.eFormInput.concat(e.eStopChat),!0),pe.a.disableElements(e.eNewChat,!1),e.inputMessageTextChatWithStranger=""}),69),this.messagesChatWithStranger=[]},formatTime:function(e){return pe.a.formatTime(e)},actionFriendRequest:function(e){je.actionFriendRequest(e)}},beforeUnmount:function(){je.disconnectStranger(),je.disconnect()}};n("0574");Oa.render=ga,Oa.__scopeId="data-v-3300e75f";var ja=Oa,va=n("4989"),ka=n.n(va),Sa={name:"App",components:{Menu:Ce,Sidebar:wt,Content:ja},data:function(){var e=ge(),t=Object(oe["c"])(e),n=t.notifyText,a=Object(oe["c"])(e),s=a.flag;return{notifyText:n,flag:s,textNotify:""}},watch:{flag:function(){this.textNotify=this.notifyText.toString(),this.showNotify()}},methods:{showNotify:function(){var e=document.getElementById("liveToast"),t=new ka.a.Toast(e);t.show()}},beforeUnmount:function(){je.disconnect(),je.disconnectStranger()}};n("5598");Sa.render=f,Sa.__scopeId="data-v-6ab2c8c6";var Ca=Sa;n("ab8b"),n("7b17"),n("845f");Object(a["c"])(Ca).use(Object(oe["a"])()).mount("#app")},"5d33":function(e,t,n){},"5f0a":function(e,t,n){var a=n("c973").default;function s(e){setTimeout((function(){var t=document.querySelector(e);t.scrollTop=3*t.scrollHeight}),50)}function c(){var e=new Date,t=e.getTime()+6e4*e.getTimezoneOffset(),n=7,a=new Date(t+36e5*(n-e.getTimezoneOffset()/60));return a}function r(e){var t=e;return"string"===typeof e&&(t=new Date(e)),t=t.toLocaleString("vi-VN",{timeZone:"UTC"}).split(" "),t[0].substr(0,t[0].lastIndexOf(":"))+" "+t[1]}function o(e,t){e.forEach((function(e){document.querySelector(e).disabled=t}))}function i(e){return e=e.toLowerCase(),e=e.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a"),e=e.replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e"),e=e.replace(/ì|í|ị|ỉ|ĩ/g,"i"),e=e.replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o"),e=e.replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u"),e=e.replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y"),e=e.replace(/đ/g,"d"),e}function u(e,t){return e.lastMessageDate>t.lastMessageDate?-1:e.lastMessageDate<t.lastMessageDate?1:0}function l(e,t){var n=window.cloudinary.createUploadWidget({cloud_name:"dwnunieno",upload_preset:"ma9pfovj",maxImageFileSize:1e7,autoMinimize:!0,sources:["local"],clientAllowedFormats:["image"],maxFiles:"Content"===e?5:1},function(){var e=a(regeneratorRuntime.mark((function e(a,s){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a||!s||"success"!==s.event){e.next=4;break}return"function"===typeof t&&t({url:s.info.url,nameFileAvatar:s.info.original_filename+"."+s.info.format}),e.next=4,n.destroy({removeThumbnails:!0}).then((function(){console.log("Widget was destroyed")}));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()).open()}n("96cf"),n("ac1f"),n("1276"),n("159b"),n("5319"),e.exports={autoSrcollTop:s,getTime:c,formatTime:r,disableElements:o,removeAccents:i,compareFn:u,openUploadModal:l}},"6b26":function(e,t,n){},"845f":function(e,t,n){},8702:function(e,t,n){},c6cf:function(e,t,n){},e7ba:function(e,t,n){e.exports=n.p+"img/redi-chat.a3f95067.svg"}});
//# sourceMappingURL=app.8b2b6c0d.js.map